{"id": "46e3dde8-e60d-43ff-b143-6810e98600cd", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport torch\nimport torch.nn as nn\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef diag_mult_kernel(\n    a_ptr,\n    b_ptr,\n    c_ptr,\n    M, \n    stride_bm, stride_bn,\n    stride_cm, stride_cn,\n    BLOCK_SIZE: tl.constexpr,\n):\n    row_idx = tl.program_id(0)\n    col_block_idx = tl.program_id(1)\n    col_offsets = col_block_idx * BLOCK_SIZE + tl.arange(0, BLOCK_SIZE)\n    col_mask = col_offsets < M\n\n    a = tl.load(a_ptr + row_idx)\n    b_ptrs = b_ptr + row_idx * stride_bm + col_offsets * stride_bn\n    b = tl.load(b_ptrs, mask=col_mask, other=0.0)\n    c = a * b\n    \n    c_ptrs = c_ptr + row_idx * stride_cm + col_offsets * stride_cn\n    tl.store(c_ptrs, c, mask=col_mask)\n\nclass ModelNew(nn.Module):\n    def __init__(self):\n        super(ModelNew, self).__init__()\n    \n    def forward(self, A, B):\n        N, M = B.shape\n        C = torch.empty_like(B)\n        stride_bm, stride_bn = B.stride()\n        stride_cm, stride_cn = C.stride()\n\n        BLOCK_SIZE = 1024\n        grid = (N, triton.cdiv(M, BLOCK_SIZE))\n        diag_mult_kernel[grid](\n            A, B, C, M, \n            stride_bm, stride_bn,\n            stride_cm, stride_cn,\n            BLOCK_SIZE,\n            num_warps=32\n        )\n        return C\n\nM = 4096\nN = 4096\n\ndef get_inputs():\n    A = torch.randn(N)\n    B = torch.randn(N, M)\n    return [A, B]\n\ndef get_init_inputs():\n    return []  # No special initialization inputs needed\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "8ca804de-5d84-46aa-8368-202d64d0a9ec", "generation": 1, "timestamp": 1754634989.2349694, "iteration_found": 3, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.438, "runtime_ms": 0.107, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:1", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0469, "speed_up": 0.438, "custom_timing": 0.107}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "reference code", "passed": false, "score": 0.0, "speed_up": 1.0, "runtime_ms": 2.66, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:0", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0469, "speed_up": 0.018, "custom_timing": 2.66}}, "island": 2}, "artifacts_json": null, "artifact_dir": null}