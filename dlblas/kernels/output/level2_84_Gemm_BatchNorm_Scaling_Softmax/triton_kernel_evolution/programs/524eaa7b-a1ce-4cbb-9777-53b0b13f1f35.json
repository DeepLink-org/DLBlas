{"id": "524eaa7b-a1ce-4cbb-9777-53b0b13f1f35", "code": "@triton.jit\ndef gemm_kernel(\n    x_ptr, w_ptr, bias_ptr, output_ptr,\n    M, N, K,\n    stride_xm, stride_xk,\n    stride_wn, stride_wk,\n    stride_om, stride_on,\n    BLOCK_M: tl.constexpr, BLOCK_N: tl.constexpr, BLOCK_K: tl.constexpr\n):\n    pid = tl.program_id(0)\n    grid_n = tl.cdiv(N, BLOCK_N)\n    pid_m = pid // grid_n\n    pid_n = pid % grid_n\n\n    offs_m = pid_m * BLOCK_M + tl.arange(0, BLOCK_M)\n    offs_n = pid_n * BLOCK_N + tl.arange(0, BLOCK_N)\n    offs_k = tl.arange(0, BLOCK_K)\n    \n    x_ptrs = x_ptr + offs_m[:, None] * stride_xm + offs_k[None, :] * stride_xk\n    w_ptrs = w_ptr + offs_k[:, None] * stride_wk + offs_n[None, :] * stride_wn\n    \n    acc = tl.zeros((BLOCK_M, BLOCK_N), dtype=tl.float32)\n    \n    for k in range(0, K, BLOCK_K):\n        k_remaining = K - k\n        k_mask = offs_k < k_remaining\n        \n        x_mask = (offs_m[:, None] < M) & k_mask[None, :]\n        x_val = tl.load(x_ptrs, mask=x_mask, other=0.0)\n        x_f16 = x_val.to(tl.float16)\n        \n        w_mask = k_mask[:, None] & (offs_n[None, :] < N)\n        w_val = tl.load(w_ptrs, mask=w_mask, other=0.0)\n        w_f16 = w_val.to(tl.float16)\n        \n        acc += tl.dot(x_f16, w_f16)\n        x_ptrs += BLOCK_K * stride_xk\n        w_ptrs += BLOCK_K * stride_wk\n    \n    if bias_ptr is not None:\n        b = tl.load(bias_ptr + offs_n, mask=offs_n < N, other=0.0)\n        acc += b[None, :]\n    \n    offs_m = tl.max_contiguous(tl.multiple_of(offs_m, BLOCK_M), BLOCK_M)\n    offs_n = tl.max_contiguous(tl.multiple_of(offs_n, BLOCK_N), BLOCK_N)\n    \n    out_ptrs = output_ptr + offs_m[:, None] * stride_om + offs_n[None, :] * stride_on\n    out_mask = (offs_m[:, None] < M) & (offs_n[None, :] < N)\n    tl.store(out_ptrs, acc, mask=out_mask)", "language": "python", "parent_id": "028a6b31-e911-4c51-8915-7832132a11e8", "generation": 4, "timestamp": 1754585311.9633222, "iteration_found": 29, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.654, "runtime_ms": 0.145, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:1", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0948, "speed_up": 0.654, "custom_timing": 0.145}}, "island": 0}, "artifacts_json": null, "artifact_dir": null}