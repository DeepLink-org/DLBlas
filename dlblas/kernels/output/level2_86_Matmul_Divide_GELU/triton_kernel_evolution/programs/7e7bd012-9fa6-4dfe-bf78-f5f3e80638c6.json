{"id": "7e7bd012-9fa6-4dfe-bf78-f5f3e80638c6", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport torch\nimport torch.nn as nn\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef fused_linear_div_gelu_kernel(\n    x_ptr, W_ptr, b_ptr, output_ptr,\n    input_size, output_size, divisor,\n    stride_x0, stride_x1,\n    stride_W0, stride_W1,\n    stride_b,\n    stride_output0, stride_output1,\n    BLOCK_K: tl.constexpr,\n):\n    pid_batch = tl.program_id(0)\n    pid_col = tl.program_id(1)\n    \n    acc = 0.0\n    for k in range(0, input_size, BLOCK_K):\n        offs_x = pid_batch * stride_x0 + (k + tl.arange(0, BLOCK_K)) * stride_x1\n        mask_x = (k + tl.arange(0, BLOCK_K)) < input_size\n        x_val = tl.load(x_ptr + offs_x, mask=mask_x, other=0.0)\n        \n        offs_W = pid_col * stride_W0 + (k + tl.arange(0, BLOCK_K)) * stride_W1\n        mask_W = (k + tl.arange(0, BLOCK_K)) < input_size\n        w_val = tl.load(W_ptr + offs_W, mask=mask_W, other=0.0)\n        \n        acc += tl.sum(x_val * w_val)\n    \n    bias_val = tl.load(b_ptr + pid_col * stride_b)\n    acc += bias_val\n    acc = acc / divisor\n    acc = acc * 0.5 * (1.0 + tl.erf(acc * 0.7071067811865475))\n    \n    offs_output = pid_batch * stride_output0 + pid_col * stride_output1\n    tl.store(output_ptr + offs_output, acc)\n\nclass ModelNew(nn.Module):\n    def __init__(self, input_size, output_size, divisor):\n        super(ModelNew, self).__init__()\n        self.input_size = input_size\n        self.output_size = output_size\n        self.divisor = divisor\n        self.weight = nn.Parameter(torch.randn(output_size, input_size))\n        self.bias = nn.Parameter(torch.randn(output_size))\n\n    def forward(self, x):\n        x = x.contiguous()\n        output = torch.empty(x.shape[0], self.output_size, device=x.device, dtype=x.dtype)\n        \n        grid = (x.shape[0], self.output_size)\n        BLOCK_K = 2\n        \n        fused_linear_div_gelu_kernel[grid](\n            x, self.weight, self.bias, output,\n            self.input_size, self.output_size, self.divisor,\n            x.stride(0), x.stride(1),\n            self.weight.stride(0), self.weight.stride(1),\n            self.bias.stride(0),\n            output.stride(0), output.stride(1),\n            BLOCK_K=BLOCK_K\n        )\n        return output\n\nbatch_size = 128\ninput_size = 512\noutput_size = 1024\ndivisor = 10.0\n\ndef get_inputs():\n    return [torch.randn(batch_size, input_size)]\n\ndef get_init_inputs():\n    return [input_size, output_size, divisor]\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "aaac6693-5ebf-4a9a-92bd-52479a32af87", "generation": 1, "timestamp": 1754580025.290517, "iteration_found": 1, "metrics": {"compiled": true, "correctness": false, "score": 10, "stage": "wrong_answer", "verify_payload": {"id": "level2_86_Matmul_Divide_GELU", "result": {"compiled": true, "correctness": false, "metadata": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "max_difference": ["10.005355", "9.882611", "10.354027", "10.421331", "10.316974"], "avg_difference": ["0.913862", "0.904048", "0.916571", "0.912452", "0.911007"], "correctness_issue": "Output mismatch", "correctness_trials": "(0 / 5)", "reference_timing_ms": 0.0527, "speed_up": -1.0, "custom_timing": -1.0}, "runtime": -1.0, "runtime_stats": {}}}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "reference code", "passed": false, "score": 0.0, "speed_up": 1.0, "runtime_ms": 0.0453, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0527, "speed_up": 1.163, "custom_timing": 0.0453}}, "island": 1}, "artifacts_json": null, "artifact_dir": null}