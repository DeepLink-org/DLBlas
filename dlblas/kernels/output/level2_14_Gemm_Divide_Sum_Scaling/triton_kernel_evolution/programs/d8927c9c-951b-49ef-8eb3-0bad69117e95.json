{"id": "d8927c9c-951b-49ef-8eb3-0bad69117e95", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport math\nimport torch\nimport torch.nn as nn\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef _forward_kernel(\n    x_ptr, \n    v_ptr, \n    output_ptr, \n    scaling_factor,\n    input_size,\n    BLOCK_SIZE: tl.constexpr\n):\n    pid = tl.program_id(0)  # row index\n    acc = 0.0\n\n    # Process input vector in blocks\n    for offset in range(0, input_size, BLOCK_SIZE):\n        idxs = offset + tl.arange(0, BLOCK_SIZE)\n        mask = idxs < input_size\n        \n        # Coalesced memory loads\n        x_vals = tl.load(x_ptr + pid * input_size + idxs, mask=mask, other=0.0)\n        v_vals = tl.load(v_ptr + idxs, mask=mask, other=0.0)\n        \n        # Fused multiply-add\n        acc += tl.sum(x_vals * v_vals)\n\n    # Apply scaling and division\n    acc = acc / 2.0 * scaling_factor\n    tl.store(output_ptr + pid, acc)\n\nclass ModelNew(nn.Module):\n    def __init__(self, input_size, hidden_size, scaling_factor):\n        super(ModelNew, self).__init__()\n        self.weight = nn.Parameter(torch.randn(hidden_size, input_size))\n        self.scaling_factor = scaling_factor\n        self.input_size = input_size\n\n    def forward(self, x):\n        v = self.weight.sum(dim=0)  # Precomputed vector\n        output = torch.empty(x.shape[0], device=x.device, dtype=torch.float32)\n        \n        # Launch Triton kernel\n        BLOCK_SIZE = 1024\n        grid = (x.shape[0],)\n        _forward_kernel[grid](\n            x, v, output, \n            self.scaling_factor, \n            self.input_size, \n            BLOCK_SIZE=BLOCK_SIZE\n        )\n        \n        return output.unsqueeze(1)\n\nbatch_size = 128\ninput_size = 10\nhidden_size = 20\nscaling_factor = 1.5\n\ndef get_inputs():\n    return [torch.randn(batch_size, input_size)]\n\ndef get_init_inputs():\n    return [input_size, hidden_size, scaling_factor]\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "fc5c33d6-d68a-4228-a84a-3c7c947bad52", "generation": 2, "timestamp": 1754566362.7327437, "iteration_found": 5, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.903, "runtime_ms": 0.0616, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:5", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0556, "speed_up": 0.903, "custom_timing": 0.0616}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "island": 2}, "artifacts_json": null, "artifact_dir": null}