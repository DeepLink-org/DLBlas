{"id": "66337241-0f68-4958-91d9-8e5a7c0326c2", "code": "@triton.jit\ndef _fused_leaky_mul_leaky_kernel(\n    x_ptr,\n    multiplier_ptr,\n    output_ptr,\n    N, C, D, H, W,\n    BLOCK_W: tl.constexpr,\n):\n    # Combine batch and channel dimensions\n    pid_nc = tl.program_id(0)\n    pid_d = tl.program_id(1)\n    pid_h = tl.program_id(2)\n    \n    # Decompose combined batch-channel index\n    n_idx = pid_nc // C\n    c_idx = pid_nc % C\n    \n    off_w = tl.arange(0, BLOCK_W)\n    w_offsets = off_w\n    mask = w_offsets < W\n    \n    # Calculate base pointer offset\n    base = n_idx * (C * D * H * W) + c_idx * (D * H * W) + pid_d * (H * W) + pid_h * W + w_offsets\n    \n    multiplier_val = tl.load(multiplier_ptr + c_idx)\n    x = tl.load(x_ptr + base, mask=mask, other=0.0)\n    \n    # Fused operations: LeakyReLU -> Multiply -> LeakyReLU\n    leaky1 = tl.where(x >= 0, x, 0.2 * x)\n    temp = leaky1 * multiplier_val\n    out = tl.where(temp >= 0, temp, 0.2 * temp)\n    \n    tl.store(output_ptr + base, out, mask=mask)\n\ndef fused_leaky_mul_leaky(x, multiplier):\n    N, C, D, H, W = x.shape\n    multiplier = multiplier.contiguous().view(-1)\n    output = torch.empty_like(x)\n    \n    # Create 3D grid: (batch*channel, depth, height)\n    grid = (N * C, D, H)\n    BLOCK_W = min(128, W)\n    \n    _fused_leaky_mul_leaky_kernel[grid](x, multiplier, output, N, C, D, H, W, BLOCK_W=BLOCK_W)\n    return output", "language": "python", "parent_id": "f10d526b-baec-46ba-a699-26b5b6ccee6f", "generation": 3, "timestamp": 1754583301.979763, "iteration_found": 25, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.006, "runtime_ms": 19.0, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.114, "speed_up": 0.006, "custom_timing": 19.0}}, "island": 2}, "artifacts_json": null, "artifact_dir": null}