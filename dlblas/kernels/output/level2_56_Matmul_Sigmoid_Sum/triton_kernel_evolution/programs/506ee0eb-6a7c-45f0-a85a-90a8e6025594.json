{"id": "506ee0eb-6a7c-45f0-a85a-90a8e6025594", "code": "@triton.autotune(\n    configs=[\n        triton.Config({}, num_warps=1),\n        triton.Config({}, num_warps=2),\n        triton.Config({}, num_warps=4),\n        triton.Config({}, num_warps=8),\n    ],\n    key=['batch_size'],\n)\n@triton.jit\ndef fused_forward_kernel(\n    x_ptr, w_ptr, b_ptr, out_ptr,\n    batch_size, input_size, hidden_size,\n    x_stride, w_stride,\n    BLOCK_IN: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    if pid >= batch_size:\n        return\n\n    # Load input row with masking\n    x_offset = pid * x_stride\n    x_vals = tl.load(\n        x_ptr + x_offset + tl.arange(0, BLOCK_IN),\n        mask=tl.arange(0, BLOCK_IN) < input_size,\n        other=0.0\n    )\n    \n    row_sum = 0.0\n    # Process each hidden unit one by one\n    for j in range(hidden_size):\n        # Load weight row for the j-th hidden unit\n        w_ptrs = w_ptr + j * w_stride + tl.arange(0, BLOCK_IN)\n        w_row = tl.load(\n            w_ptrs,\n            mask=tl.arange(0, BLOCK_IN) < input_size,\n            other=0.0\n        )\n        \n        # Load bias for j-th hidden unit\n        b_val = tl.load(b_ptr + j)\n        \n        # Compute dot product\n        dot = tl.sum(x_vals * w_row) + b_val\n        # Sigmoid\n        s = 1.0 / (1.0 + tl.exp(-dot))\n        row_sum += s\n    \n    # Store result\n    tl.store(out_ptr + pid, row_sum)", "language": "python", "parent_id": "6871d67b-ab43-42a9-8db2-170c45830f84", "generation": 3, "timestamp": 1754576073.4144766, "iteration_found": 25, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.69, "runtime_ms": 0.07, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:5", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0483, "speed_up": 0.69, "custom_timing": 0.07}}, "island": 1}, "artifacts_json": null, "artifact_dir": null}