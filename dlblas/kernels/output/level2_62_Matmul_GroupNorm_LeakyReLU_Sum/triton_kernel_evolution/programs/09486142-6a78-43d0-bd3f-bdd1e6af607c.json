{"id": "09486142-6a78-43d0-bd3f-bdd1e6af607c", "code": "@triton.jit\ndef group_norm_fused_kernel(\n    input_ptr,\n    weight_ptr,\n    bias_ptr,\n    output_ptr,\n    n_elements,\n    hidden_size,\n    num_groups,\n    eps,\n    negative_slope,\n    BLOCK_SIZE: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    group_id = pid % num_groups\n    row_id = pid // num_groups\n    group_size = hidden_size // num_groups\n    \n    # Calculate the base offsets\n    base_input_offset = row_id * hidden_size + group_id * group_size\n    base_param_offset = group_id * group_size\n    \n    # Create the offsets for the current block\n    block_offset = tl.arange(0, BLOCK_SIZE)\n    input_offset = base_input_offset + block_offset\n    param_offset = base_param_offset + block_offset\n    \n    mask = block_offset < group_size\n    \n    # Load input data for this group\n    x = tl.load(input_ptr + input_offset, mask=mask, other=0.0)\n    w = tl.load(weight_ptr + param_offset, mask=mask, other=1.0)\n    b = tl.load(bias_ptr + param_offset, mask=mask, other=0.0)\n    \n    # Compute mean and variance for group normalization\n    group_sum = tl.sum(x, axis=0)\n    group_mean = group_sum / group_size\n    x_centered = tl.where(mask, x - group_mean, 0.0)\n    group_var = tl.sum(x_centered * x_centered, axis=0) / group_size + eps\n    \n    # Normalize and apply affine transformation\n    x_norm = x_centered * tl.math.rsqrt(group_var)\n    y = x_norm * w + b\n    \n    # Apply LeakyReLU and double the output (x + x equivalent)\n    y = tl.where(y >= 0, y, y * negative_slope) * 2.0\n    tl.store(output_ptr + input_offset, y, mask=mask)", "language": "python", "parent_id": "f4b68022-8c39-4626-858d-0882aeba2e78", "generation": 2, "timestamp": 1754572852.4196057, "iteration_found": 8, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": false, "score": 10, "stage": "wrong_answer", "verify_payload": {"id": "level2_62_Matmul_GroupNorm_LeakyReLU_Sum", "result": {"compiled": true, "correctness": false, "metadata": {"hardware": "NVIDIA L20Y", "device": "cuda:7", "max_difference": ["7.498710", "24.586992", "122.700798", "19.543716", "56.470238"], "avg_difference": ["0.972354", "1.003179", "2.323081", "0.994045", "2.277081"], "correctness_issue": "Output mismatch", "correctness_trials": "(0 / 5)", "reference_timing_ms": 0.0821, "speed_up": -1.0, "custom_timing": -1.0}, "runtime": -1.0, "runtime_stats": {}}}}, "island": 1}, "artifacts_json": null, "artifact_dir": null}