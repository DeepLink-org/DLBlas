{"id": "2a547fb8-2f83-4972-b67e-8a19fa82d779", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport torch\nimport torch.nn as nn\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef double_mish_kernel(\n    x_ptr,\n    output_ptr,\n    n_elements,\n    BLOCK_SIZE: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    off = pid * BLOCK_SIZE + tl.arange(0, BLOCK_SIZE)\n    mask = off < n_elements\n\n    x_val = tl.load(x_ptr + off, mask=mask)\n\n    # Optimized double Mish with reduced operations\n    # First Mish: x * tanh(softplus(x))\n    t = tl.log(1 + tl.exp(x_val))\n    t = 2 * tl.sigmoid(2 * t) - 1  # tanh(t)\n    mish1 = x_val * t\n    \n    # Second Mish: mish1 * tanh(softplus(mish1))\n    u = tl.log(1 + tl.exp(mish1))\n    u = 2 * tl.sigmoid(2 * u) - 1  # tanh(u)\n    mish2 = mish1 * u\n\n    tl.store(output_ptr + off, mish2, mask=mask)\n\ndef double_mish(x: torch.Tensor) -> torch.Tensor:\n    if not x.is_contiguous():\n        x = x.contiguous()\n    output = torch.empty_like(x)\n    n_elements = x.numel()\n    \n    # Optimized configuration for H100 architecture\n    BLOCK_SIZE = 1024\n    num_warps = 32\n    grid = (triton.cdiv(n_elements, BLOCK_SIZE),)\n    double_mish_kernel[grid](\n        x, output, n_elements, \n        BLOCK_SIZE=BLOCK_SIZE,\n        num_warps=num_warps\n    )\n    return output\n\nclass ModelNew(nn.Module):\n    def __init__(self, in_channels, out_channels, kernel_size):\n        super(ModelNew, self).__init__()\n        self.conv = nn.Conv2d(in_channels, out_channels, kernel_size)\n\n    def forward(self, x):\n        x = self.conv(x)\n        x = double_mish(x)  # Fused double Mish activation\n        return x\n\nbatch_size = 128\nin_channels = 3\nout_channels = 16\nheight, width = 32, 32\nkernel_size = 3\n\ndef get_inputs():\n    return [torch.randn(batch_size, in_channels, height, width)]\n\ndef get_init_inputs():\n    return [in_channels, out_channels, kernel_size]\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "e2c79828-09fa-48d8-819e-618b3e480e95", "generation": 5, "timestamp": 1754576444.9598455, "iteration_found": 28, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.712, "runtime_ms": 0.0778, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0554, "speed_up": 0.712, "custom_timing": 0.0778}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.632, "runtime_ms": 0.0876, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:1", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0554, "speed_up": 0.632, "custom_timing": 0.0876}}, "island": 2}, "artifacts_json": null, "artifact_dir": null}