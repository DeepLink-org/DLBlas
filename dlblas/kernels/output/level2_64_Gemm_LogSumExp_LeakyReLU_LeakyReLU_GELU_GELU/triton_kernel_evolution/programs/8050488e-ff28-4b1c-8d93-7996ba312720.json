{"id": "8050488e-ff28-4b1c-8d93-7996ba312720", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport torch\nimport torch.nn as nn\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef _logsumexp_kernel(\n    x_ptr,\n    output_ptr,\n    stride_x,\n    n_cols,\n    BLOCK_SIZE: tl.constexpr,\n):\n    row_idx = tl.program_id(0)\n    row_start = row_idx * stride_x\n    offsets = row_start + tl.arange(0, BLOCK_SIZE)\n    mask = tl.arange(0, BLOCK_SIZE) < n_cols\n    \n    chunk = tl.load(x_ptr + offsets, mask=mask, other=-float('inf'))\n    row_max = tl.max(chunk, axis=0)\n    \n    row_exp = tl.where(mask, tl.exp(chunk - row_max), 0.0)\n    row_sum = tl.sum(row_exp, axis=0)\n    log_sum = tl.log(row_sum) + row_max\n    \n    tl.store(output_ptr + row_idx, log_sum)\n\ndef triton_logsumexp(x, dim=1, keepdim=True):\n    M, N = x.shape\n    output = torch.empty(M, device=x.device, dtype=x.dtype)\n    \n    grid = (M,)\n    BLOCK_SIZE = min(triton.next_power_of_2(N), 1024)\n    \n    _logsumexp_kernel[grid](\n        x, output, x.stride(0), N,\n        BLOCK_SIZE=BLOCK_SIZE\n    )\n    return output.view(-1, 1) if keepdim else output\n\nclass ModelNew(nn.Module):\n    def __init__(self, in_features, out_features, bias=True):\n        super(ModelNew, self).__init__()\n        self.linear = nn.Linear(in_features, out_features, bias=bias)\n\n    def forward(self, x):\n        x = self.linear(x)\n        x = triton_logsumexp(x, dim=1, keepdim=True)\n        x = torch.nn.functional.leaky_relu(x, negative_slope=0.01)\n        x = torch.nn.functional.leaky_relu(x, negative_slope=0.01)\n        x = torch.nn.functional.gelu(x)\n        x = torch.nn.functional.gelu(x)\n        return x\n\nbatch_size = 128\nin_features = 1024\nout_features = 512\n\ndef get_inputs():\n    return [torch.randn(batch_size, in_features)]\n\ndef get_init_inputs():\n    return [in_features, out_features]\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "1f0f7358-973a-41dd-b91b-c171e5bd5c7f", "generation": 1, "timestamp": 1754580276.7974012, "iteration_found": 1, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": true, "score": 46.499999999999986, "speed_up": 1.265, "runtime_ms": 0.0996, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:1", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.126, "speed_up": 1.265, "custom_timing": 0.0996}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "reference code", "passed": false, "score": 0.0, "speed_up": 1.0, "runtime_ms": 0.114, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:1", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.126, "speed_up": 1.105, "custom_timing": 0.114}}, "island": 0}, "artifacts_json": null, "artifact_dir": null}