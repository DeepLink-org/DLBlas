{"id": "6e4ceea7-aef5-408d-929d-f1e0b9a2c879", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef adaptive_avg_pool2d_kernel(\n    input_ptr,\n    output_ptr,\n    input_batch_stride, input_channel_stride, input_height_stride, input_width_stride,\n    output_batch_stride, output_channel_stride,\n    input_h, input_w,\n    BLOCK_SIZE: tl.constexpr = 64,\n):\n    pid_batch = tl.program_id(0)\n    pid_channel = tl.program_id(1)\n    \n    base_offset = pid_batch * input_batch_stride + pid_channel * input_channel_stride\n\n    total = 0.0\n    count = 0\n    \n    for row_start in range(0, input_h, BLOCK_SIZE):\n        row_idx = row_start + tl.arange(0, BLOCK_SIZE)\n        row_mask = row_idx < input_h\n        row_offset = row_idx * input_height_stride\n        \n        for col_start in range(0, input_w, BLOCK_SIZE):\n            col_idx = col_start + tl.arange(0, BLOCK_SIZE)\n            col_mask = col_idx < input_w\n            col_offset = col_idx * input_width_stride\n            \n            full_mask = row_mask[:, None] & col_mask[None, :]\n            offsets = base_offset + row_offset[:, None] + col_offset[None, :]\n            \n            block = tl.load(input_ptr + offsets, mask=full_mask, other=0.0)\n            total += tl.sum(block)\n            count += tl.sum(full_mask)\n    \n    avg = total / count if count > 0 else 0.0\n    out_offset = pid_batch * output_batch_stride + pid_channel * output_channel_stride\n    tl.store(output_ptr + out_offset, avg)\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "be38b658-7ccc-45e1-8118-c4dae7387f68", "generation": 3, "timestamp": 1754592673.1352417, "iteration_found": 19, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.894, "runtime_ms": 10.2, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:7", "correctness_trials": "(5 / 5)", "reference_timing_ms": 9.12, "speed_up": 0.894, "custom_timing": 10.2}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "island": 2}, "artifacts_json": null, "artifact_dir": null}