{"id": "4ba46ad1-7b8f-4dfe-8fe7-95a98d0803b0", "code": "# ================== EVOLVE-BLOCK-START ==================\nimport triton\nimport triton.language as tl\n\n@triton.jit\ndef adaptive_avg_pool2d_kernel(\n    input_ptr,\n    output_ptr,\n    input_h,\n    input_w,\n    input_batch_stride, input_channel_stride, input_height_stride, input_width_stride,\n    output_batch_stride, output_channel_stride,\n    BLOCK_SIZE: tl.constexpr,\n):\n    pid_batch = tl.program_id(0)\n    pid_channel = tl.program_id(1)\n    \n    # Calculate base offset for this batch and channel\n    base_offset = pid_batch * input_batch_stride + pid_channel * input_channel_stride\n\n    # Initialize accumulators\n    total = 0.0\n    num_elements = 0\n    total_elements = input_h * input_w\n    \n    # Process flattened image as 1D contiguous blocks\n    for start in range(0, total_elements, BLOCK_SIZE):\n        idx = start + tl.arange(0, BLOCK_SIZE)\n        mask = idx < total_elements\n        \n        # Calculate row and column indices\n        row = idx // input_w\n        col = idx % input_w\n        \n        # Compute memory offsets\n        offsets = base_offset + row * input_height_stride + col * input_width_stride\n        \n        # Load input values with masking\n        values = tl.load(input_ptr + offsets, mask=mask, other=0.0)\n        total += tl.sum(values)\n        num_elements += tl.sum(mask)\n    \n    # Compute average and store result\n    average = total / num_elements\n    output_offset = pid_batch * output_batch_stride + pid_channel * output_channel_stride\n    tl.store(output_ptr + output_offset, average)\n# =================== EVOLVE-BLOCK-END ===================", "language": "python", "parent_id": "140531ed-f217-48db-b4b8-018e39063bec", "generation": 3, "timestamp": 1754592050.055376, "iteration_found": 16, "metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.885, "runtime_ms": 10.3, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "correctness_trials": "(5 / 5)", "reference_timing_ms": 9.12, "speed_up": 0.885, "custom_timing": 10.3}}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.903, "runtime_ms": 10.1, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:3", "correctness_trials": "(5 / 5)", "reference_timing_ms": 9.12, "speed_up": 0.903, "custom_timing": 10.1}}, "island": 2}, "artifacts_json": null, "artifact_dir": null}