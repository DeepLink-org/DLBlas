{"id": "19799ecb-494a-4361-bbd6-5ce6ce499c4e", "code": "@triton.jit\ndef _fused_linear_sigmoid_sum(\n    x_ptr, w_ptr, b_ptr, output_ptr, \n    batch_size, input_size, hidden_size,\n    BLOCK_INPUT: tl.constexpr,   # Rename from BLOCK_SIZE to BLOCK_INPUT\n    BLOCK_HIDDEN: tl.constexpr   # New block size for hidden dimension\n):\n    pid = tl.program_id(0)\n    if pid >= batch_size:\n        return\n\n    # Load the input vector for this example\n    input_offset = pid * input_size\n    arange_input = tl.arange(0, BLOCK_INPUT)\n    mask_input = arange_input < input_size\n    x = tl.load(x_ptr + input_offset + arange_input, mask=mask_input, other=0.0)\n\n    # Initialize accumulator for the example\n    row_sum = 0.0\n\n    # Loop over hidden units in chunks of BLOCK_HIDDEN\n    for j_start in range(0, hidden_size, BLOCK_HIDDEN):\n        j_offs = j_start + tl.arange(0, BLOCK_HIDDEN)\n        mask_hidden = j_offs < hidden_size\n\n        # Load the bias for the current chunk of hidden units\n        bias_chunk = tl.load(b_ptr + j_offs, mask=mask_hidden, other=0.0)\n\n        # Initialize the dot products for the chunk to the bias\n        dot_chunk = bias_chunk\n\n        # Load the weights for the chunk: [BLOCK_HIDDEN, BLOCK_INPUT]\n        w_ptrs = w_ptr + j_offs[:, None] * input_size + arange_input[None, :]\n        w_chunk = tl.load(w_ptrs, mask=mask_hidden[:, None] & mask_input[None, :], other=0.0)\n\n        # Compute the dot product: for each hidden unit in the chunk, dot = sum(x * w_chunk[i])\n        dot_chunk += tl.sum(x[None, :] * w_chunk, axis=1)\n\n        # Apply sigmoid\n        sig_chunk = 1.0 / (1.0 + tl.exp(-dot_chunk))\n\n        # Sum the sigmoid values in the chunk (only the active ones)\n        chunk_sum = tl.sum(tl.where(mask_hidden, sig_chunk, 0.0))\n        row_sum += chunk_sum\n\n    tl.store(output_ptr + pid, row_sum)", "language": "python", "parent_id": "dd50b03b-bf84-4b67-9180-369ecfd09310", "generation": 3, "timestamp": 1754576530.563463, "iteration_found": 27, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": true, "score": 57.79999999999999, "speed_up": 1.378, "runtime_ms": 0.0798, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:6", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.11, "speed_up": 1.378, "custom_timing": 0.0798}}, "island": 2}, "artifacts_json": null, "artifact_dir": null}