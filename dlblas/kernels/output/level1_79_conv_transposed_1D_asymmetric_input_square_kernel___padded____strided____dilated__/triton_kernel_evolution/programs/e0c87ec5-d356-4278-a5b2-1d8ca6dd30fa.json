{"id": "e0c87ec5-d356-4278-a5b2-1d8ca6dd30fa", "code": "@triton.jit\ndef conv_transpose1d_kernel(\n    x_ptr,\n    weight_ptr,\n    bias_ptr,\n    output_ptr,\n    batch_size,\n    in_channels,\n    out_channels,\n    length_in,\n    length_out,\n    kernel_size: tl.constexpr,\n    stride,\n    padding,\n    dilation,\n    numel,\n    BLOCK_SIZE: tl.constexpr,\n    BLOCK_C: tl.constexpr\n):\n    pid = tl.program_id(0)\n    offs = pid * BLOCK_SIZE + tl.arange(0, BLOCK_SIZE)\n    mask = offs < numel\n\n    output_channels_length = out_channels * length_out\n    b_idx = offs // output_channels_length\n    remainder = offs % output_channels_length\n    c_out_idx = remainder // length_out\n    i_out = remainder % length_out\n\n    acc = tl.zeros((BLOCK_SIZE,), dtype=tl.float32)\n    \n    if bias_ptr is not None:\n        bias = tl.load(bias_ptr + c_out_idx, mask=mask, other=0.0)\n        acc += bias\n\n    for k in tl.static_range(kernel_size):\n        numerator = i_out + padding - k * dilation\n        cond1 = numerator >= 0\n        cond2 = (numerator % stride) == 0\n        j = numerator // stride\n        cond3 = (j >= 0) & (j < length_in)\n        cond = cond1 & cond2 & cond3\n\n        for c_in_block in range(0, in_channels, BLOCK_C):\n            c_in_offsets = c_in_block + tl.arange(0, BLOCK_C)\n            c_in_mask = c_in_offsets < in_channels\n\n            input_ptrs = (\n                x_ptr + \n                b_idx[:, None] * (in_channels * length_in) + \n                c_in_offsets[None, :] * length_in + \n                j[:, None]\n            )\n            weight_ptrs = (\n                weight_ptr + \n                c_in_offsets[None, :] * (out_channels * kernel_size) + \n                c_out_idx[:, None] * kernel_size + \n                k\n            )\n            \n            mask2d = mask[:, None] & cond[:, None] & c_in_mask[None, :]\n            x_vals = tl.load(input_ptrs, mask=mask2d, other=0.0)\n            w_vals = tl.load(weight_ptrs, mask=mask2d, other=0.0)\n            \n            product = x_vals * w_vals\n            acc += tl.sum(product, axis=1)\n\n    tl.store(output_ptr + offs, acc, mask=mask)", "language": "python", "parent_id": "9e1ba546-cd1c-469d-b364-125751250680", "generation": 3, "timestamp": 1754993896.5095024, "iteration_found": 19, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.564, "runtime_ms": 0.129, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:2", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.0728, "speed_up": 0.564, "custom_timing": 0.129}}, "island": 1}, "artifacts_json": null, "artifact_dir": null}