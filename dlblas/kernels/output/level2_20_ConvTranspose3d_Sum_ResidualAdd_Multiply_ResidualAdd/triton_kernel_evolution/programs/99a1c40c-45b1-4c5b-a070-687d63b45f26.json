{"id": "99a1c40c-45b1-4c5b-a070-687d63b45f26", "code": "@triton.autotune(\n    configs=[\n        triton.Config({'BLOCK_SIZE': 128, 'VEC_SIZE': 4}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 128, 'VEC_SIZE': 8}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 256, 'VEC_SIZE': 4}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 256, 'VEC_SIZE': 8}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 512, 'VEC_SIZE': 4}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 512, 'VEC_SIZE': 8}, num_warps=4),\n        triton.Config({'BLOCK_SIZE': 128, 'VEC_SIZE': 4}, num_warps=8),\n        triton.Config({'BLOCK_SIZE': 128, 'VEC_SIZE': 8}, num_warps=8),\n        triton.Config({'BLOCK_SIZE': 256, 'VEC_SIZE': 4}, num_warps=8),\n        triton.Config({'BLOCK_SIZE': 256, 'VEC_SIZE': 8}, num_warps=8),\n        triton.Config({'BLOCK_SIZE': 512, 'VEC_SIZE': 4}, num_warps=8),\n        triton.Config({'BLOCK_SIZE': 512, 'VEC_SIZE': 8}, num_warps=8),\n    ],\n    key=['S'],\n)\n@triton.jit\ndef _fused_kernel_2d(\n    T_ptr,\n    bias_ptr,\n    output_ptr,\n    S,  # spatial size per channel\n    C,  # number of channels\n    batch_size,\n    BLOCK_SIZE: tl.constexpr,\n    VEC_SIZE: tl.constexpr,\n):\n    pid_batch = tl.program_id(0)\n    pid_channel = tl.program_id(1)\n    pid_block = tl.program_id(2)\n\n    # Calculate the base pointer for the current batch and channel\n    base = pid_batch * C * S + pid_channel * S\n    spatial_start = pid_block * BLOCK_SIZE\n    bias_val = tl.load(bias_ptr + pid_channel)\n\n    # Loop over the spatial block in chunks of VEC_SIZE\n    for i in range(0, BLOCK_SIZE, VEC_SIZE):\n        off = spatial_start + i\n        vec_offsets = off + tl.arange(0, VEC_SIZE)\n        mask = vec_offsets < S  # because we are within a channel, so we must not exceed S\n\n        # Load the input vector\n        ptr = T_ptr + base + vec_offsets\n        T_vec = tl.load(ptr, mask=mask, other=0.0)\n\n        # Compute: result = T_val * (2 * T_val + bias_val + 1)\n        result_vec = T_vec * (2 * T_vec + bias_val + 1.0)\n\n        # Store the result\n        out_ptr = output_ptr + base + vec_offsets\n        tl.store(out_ptr, result_vec, mask=mask)", "language": "python", "parent_id": "17f0f41f-297b-4d4f-8e33-ab3b559ed6ac", "generation": 2, "timestamp": 1754568968.8429754, "iteration_found": 17, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.107, "runtime_ms": 1.55, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:2", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.166, "speed_up": 0.107, "custom_timing": 1.55}}, "island": 0}, "artifacts_json": null, "artifact_dir": null}