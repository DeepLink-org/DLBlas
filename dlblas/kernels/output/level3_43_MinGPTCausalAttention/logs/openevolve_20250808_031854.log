2025-08-08 03:18:54,565 - openevolve.controller - INFO - Logging to openevolve_output/level3_43_MinGPTCausalAttention/logs/openevolve_20250808_031854.log
2025-08-08 03:18:54,566 - openevolve.controller - INFO - Set random seed to 42 for reproducibility
2025-08-08 03:18:54,605 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:18:54,644 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:18:54,644 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 03:18:54,645 - openevolve.database - INFO - Initialized program database with 0 programs
2025-08-08 03:18:54,666 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:18:54,666 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:18:54,667 - openevolve.controller - INFO - Initialized OpenEvolve with /tmp/141f1957d6c601dc77e5c6f11168e697.py
2025-08-08 03:18:54,667 - openevolve.controller - INFO - Adding initial program to database
2025-08-08 03:18:54,670 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(2736 chars)
2025-08-08 03:19:05,124 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:19:05,125 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.025,"custom_timing":12.9},"runtime":12.9,"runtime_stats":{"mean":12.9,"std":0.156,"min":12.8,"max":13.4,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:3"}}}
2025-08-08 03:19:05,125 - openevolve.evaluator - INFO - Evaluated program 7b28180a-4479-44da-82f9-841c24420a2b in 10.46s: compiled=1.0000, correctness=1.0000, stage=reference code, passed=0.0000, score=0.0000, speed_up=1.0000, runtime_ms=12.9000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.025, 'custom_timing': 12.9}
2025-08-08 03:19:05,125 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 0, 'complexity': 2}
2025-08-08 03:19:05,139 - openevolve.threaded_parallel - INFO - Initializing threaded evaluation pool with 3 workers
2025-08-08 03:19:05,140 - openevolve.threaded_parallel - INFO - Started thread pool with 3 threads
2025-08-08 03:19:05,140 - openevolve.threaded_parallel - INFO - Started improved parallel controller
2025-08-08 03:19:05,141 - openevolve.controller - INFO - Using island-based evolution with 3 islands
2025-08-08 03:19:05,141 - openevolve.database - INFO - Island Status:
2025-08-08 03:19:05,141 - openevolve.database - INFO -  * Island 0: 1 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0 (best: 7b28180a-4479-44da-82f9-841c24420a2b)
2025-08-08 03:19:05,141 - openevolve.database - INFO -    Island 1: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 03:19:05,141 - openevolve.database - INFO -    Island 2: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 03:19:05,141 - openevolve.threaded_parallel - INFO - Starting improved parallel evolution from iteration 0 for 30 iterations (total: 30)
2025-08-08 03:19:05,272 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,275 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,275 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,409 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,409 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 03:19:05,409 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,410 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 03:19:05,411 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 03:19:05,412 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 03:19:05,412 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,412 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,413 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,413 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,414 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,414 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_43_MinGPTCausalAttention/evaluation.py
2025-08-08 03:19:05,415 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:19:05,416 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:19:05,417 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:32:45,140 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:32:45,143 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3686 chars)
2025-08-08 03:32:48,392 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:32:48,392 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 574, in arange\n    raise ValueError(\"arange's arguments must be of type tl.constexpr\")\nValueError: arange's arguments must be of type tl.constexpr\n\nThe above exception was the direct c
2025-08-08 03:32:48,393 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:32:48,393 - openevolve.evaluator - INFO - Evaluated program 40aa2568-64cc-46cb-8820-e39340be1363 in 3.25s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:32:48,396 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:32:48,397 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 9}
2025-08-08 03:32:48,397 - openevolve.database - INFO - New best program 40aa2568-64cc-46cb-8820-e39340be1363 replaces 7b28180a-4479-44da-82f9-841c24420a2b
2025-08-08 03:32:48,409 - openevolve.threaded_parallel - INFO - Iteration 2: Program 40aa2568-64cc-46cb-8820-e39340be1363 (parent: 7b28180a-4479-44da-82f9-841c24420a2b) completed in 822.98s
2025-08-08 03:32:48,409 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:32:48,410 - openevolve.threaded_parallel - INFO - ðŸŒŸ New best solution found at iteration 2: 40aa2568-64cc-46cb-8820-e39340be1363
2025-08-08 03:33:10,934 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:33:10,934 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5108 chars)
2025-08-08 03:33:14,222 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:33:14,222 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:6","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 2231, in make_block_ptr\n    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 1838, in make_block_ptr\n    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))\n  File \"/h
2025-08-08 03:33:14,222 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:33:14,223 - openevolve.evaluator - INFO - Evaluated program 74c08639-5272-4781-8f38-ce1ab5b3ad84 in 3.29s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2231, in make_block_ptr\n    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1838, in make_block_ptr\n    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 726, in __init__\n    self.numel = validate_block_shape(self.shape)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/_utils.py", line 52, in validate_block_shape\n    raise ValueError(f"Shape element {i} must be a power of 2")\nValueError: Shape element 1 must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpgm7rpu0n.py", line 131, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpgm7rpu0n.py", line 98, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 17:18:\n    stride_oz, stride_oh, stride_om, stride_on,\n    seq_len,\n    BLOCK_M: tl.constexpr, BLOCK_DMODEL: tl.constexpr,\n    BLOCK_N: tl.constexpr,\n):\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n    off_z = off_hz // stride_qh\n    off_h = off_hz % stride_qh\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    Q_block_ptr = tl.make_block_ptr(\n                  ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2231, in make_block_ptr\n    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1838, in make_block_ptr\n    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 726, in __init__\n    self.numel = validate_block_shape(self.shape)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/_utils.py", line 52, in validate_block_shape\n    raise ValueError(f"Shape element {i} must be a power of 2")\nValueError: Shape element 1 must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:33:14,226 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:33:14,240 - openevolve.threaded_parallel - INFO - Iteration 0: Program 74c08639-5272-4781-8f38-ce1ab5b3ad84 (parent: 7b28180a-4479-44da-82f9-841c24420a2b) completed in 848.81s
2025-08-08 03:33:14,241 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2231, in make_block_ptr\n    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1838, in make_block_ptr\n    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 726, in __init__\n    self.numel = validate_block_shape(self.shape)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/_utils.py", line 52, in validate_block_shape\n    raise ValueError(f"Shape element {i} must be a power of 2")\nValueError: Shape element 1 must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpgm7rpu0n.py", line 131, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpgm7rpu0n.py", line 98, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 17:18:\n    stride_oz, stride_oh, stride_om, stride_on,\n    seq_len,\n    BLOCK_M: tl.constexpr, BLOCK_DMODEL: tl.constexpr,\n    BLOCK_N: tl.constexpr,\n):\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n    off_z = off_hz // stride_qh\n    off_h = off_hz % stride_qh\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    Q_block_ptr = tl.make_block_ptr(\n                  ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2231, in make_block_ptr\n    return _semantic.make_block_ptr(base, shape, strides, offsets, block_shape, order)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1838, in make_block_ptr\n    return self.tensor(handle, tl.pointer_type(tl.block_type(base.type.element_ty, block_shape)))\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 726, in __init__\n    self.numel = validate_block_shape(self.shape)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/_utils.py", line 52, in validate_block_shape\n    raise ValueError(f"Shape element {i} must be a power of 2")\nValueError: Shape element 1 must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:33:14,241 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 0
2025-08-08 03:33:14,241 - openevolve.database - INFO - Island Status:
2025-08-08 03:33:14,241 - openevolve.database - INFO -  * Island 0: 3 programs, best=10.0000, avg=6.6667, diversity=707.67, gen=2 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 03:33:14,241 - openevolve.database - INFO -    Island 1: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 03:33:14,241 - openevolve.database - INFO -    Island 2: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 03:33:14,328 - openevolve.database - INFO - Saved database with 3 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_0
2025-08-08 03:33:14,345 - openevolve.controller - INFO - Saved best program at checkpoint 0 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:33:14,345 - openevolve.controller - INFO - Saved checkpoint at iteration 0 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_0
2025-08-08 03:34:24,518 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:34:24,520 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5226 chars)
2025-08-08 03:34:27,843 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:34:27,843 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 574, in arange\n    raise ValueError(\"arange's arguments must be of type tl.constexpr\")\nValueError: arange's arguments must be of type tl.constexpr\n\nThe above exception was the direct c
2025-08-08 03:34:27,843 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:34:27,843 - openevolve.evaluator - INFO - Evaluated program 318249e1-d611-4dc4-9d29-05540ab8d0cb in 3.33s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpisv3xqr5.py", line 96, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 22:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:34:27,847 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:34:27,864 - openevolve.threaded_parallel - INFO - Iteration 1: Program 318249e1-d611-4dc4-9d29-05540ab8d0cb (parent: 7b28180a-4479-44da-82f9-841c24420a2b) completed in 922.43s
2025-08-08 03:34:27,864 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpisv3xqr5.py", line 96, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 22:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:37:57,666 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:37:57,668 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3704 chars)
2025-08-08 03:38:01,421 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:38:01,421 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:6","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 03:38:01,421 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:38:01,421 - openevolve.evaluator - INFO - Evaluated program e4667342-7683-48ef-8df0-e1cc272d3415 in 3.76s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpemwwfz3l.py", line 86, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:28:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:38:01,425 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:38:01,429 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 3}
2025-08-08 03:38:01,445 - openevolve.threaded_parallel - INFO - Iteration 4: Program e4667342-7683-48ef-8df0-e1cc272d3415 (parent: 40aa2568-64cc-46cb-8820-e39340be1363) completed in 287.20s
2025-08-08 03:38:01,446 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpemwwfz3l.py", line 86, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:28:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:39:14,829 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:39:14,831 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3784 chars)
2025-08-08 03:39:18,463 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:39:18,463 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 03:39:18,463 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:39:18,464 - openevolve.evaluator - INFO - Evaluated program 0a428707-e8b3-461c-938e-d2888874459f in 3.64s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp3ewuxmeq.py", line 87, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:13:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D)\n             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:39:18,469 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:39:18,470 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 4}
2025-08-08 03:39:18,481 - openevolve.threaded_parallel - INFO - Iteration 5: Program 0a428707-e8b3-461c-938e-d2888874459f (parent: 40aa2568-64cc-46cb-8820-e39340be1363) completed in 290.62s
2025-08-08 03:39:18,482 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp3ewuxmeq.py", line 87, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:13:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D)\n             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:43:56,857 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:43:56,858 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5251 chars)
2025-08-08 03:44:00,352 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:44:00,353 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 03:44:00,353 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:44:00,353 - openevolve.evaluator - INFO - Evaluated program 34bfe864-b5e0-4b29-8f8e-4f4798256f5f in 3.50s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpdohs64sz.py", line 97, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:44:00,357 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:44:00,378 - openevolve.threaded_parallel - INFO - Iteration 6: Program 34bfe864-b5e0-4b29-8f8e-4f4798256f5f (parent: 318249e1-d611-4dc4-9d29-05540ab8d0cb) completed in 358.93s
2025-08-08 03:44:00,378 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpdohs64sz.py", line 97, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:44:00,378 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 6
2025-08-08 03:44:00,379 - openevolve.database - INFO - Island Status:
2025-08-08 03:44:00,379 - openevolve.database - INFO -    Island 0: 5 programs, best=10.0000, avg=8.0000, diversity=343.82, gen=3 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 03:44:00,379 - openevolve.database - INFO -  * Island 1: 1 programs, best=10.0000, avg=10.0000, diversity=0.00, gen=2 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 03:44:00,379 - openevolve.database - INFO -    Island 2: 1 programs, best=10.0000, avg=10.0000, diversity=0.00, gen=1 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 03:44:00,460 - openevolve.database - INFO - Saved database with 7 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_6
2025-08-08 03:44:00,476 - openevolve.controller - INFO - Saved best program at checkpoint 6 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:44:00,476 - openevolve.controller - INFO - Saved checkpoint at iteration 6 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_6
2025-08-08 03:45:08,562 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:45:08,564 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5809 chars)
2025-08-08 03:45:12,770 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:45:12,770 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"error":"CUDA error: an illegal memory access was encountered\nCUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.\nFor debugging consider passing CUDA_LAUNCH_BLOCKING=1\nCompile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.\n\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 173, in _verification_worker\n    result: KernelExecResult = eval_kernel_against_ref(\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 578, in eval_kernel_against_ref\n    graceful_eval_cleanup(context, device, tempfile)\n  File \"/cpfs01/shared/ll
2025-08-08 03:45:12,770 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ compile_error
2025-08-08 03:45:12,770 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_0c2d0d] execute payload: {id:level3_43_MinGPTCausalAttention_0c2d0d, device_type:NV_LY_20}
2025-08-08 03:45:14,837 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_0c2d0d] execute request success
2025-08-08 03:45:14,838 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_0c2d0d] execute response: {"id":"level3_43_MinGPTCausalAttention_0c2d0d","exit_code":"1","content":"[Child] ç»‘å®š GPU 2, torch sees 1 device(s)\n\n[Exception]\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py\", line 71, in _exec_worker\n    exec(textwrap.dedent(code_src), mod.__dict__)\n  File \"<string>\", line 10, in <module>\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py\", line 844, in jit\n    return decorator(fn)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py\", line 832, in decorator\n    return JITFunction(\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py\", line 635, in __init__\n    self.startin
2025-08-08 03:45:14,838 - openevolve.evaluator - INFO - Evaluated program 0c3e89ab-41b0-493b-b53e-e70674937193 in 6.28s: compiled=0.0000, correctness=0.0000, score=1.0000, stage=compile_error, compile_log=CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 173, in _verification_worker
    result: KernelExecResult = eval_kernel_against_ref(
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 578, in eval_kernel_against_ref
    graceful_eval_cleanup(context, device, tempfile)
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 230, in graceful_eval_cleanup
    torch.cuda.empty_cache()
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/cuda/memory.py", line 224, in empty_cache
    torch._C._cuda_emptyCache()
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

, exec_log=[Child] ç»‘å®š GPU 2, torch sees 1 device(s)

[Exception]
Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py", line 71, in _exec_worker
    exec(textwrap.dedent(code_src), mod.__dict__)
  File "<string>", line 10, in <module>
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 844, in jit
    return decorator(fn)
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 832, in decorator
    return JITFunction(
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 635, in __init__
    self.starting_line_number = inspect.getsourcelines(fn)[1]
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/inspect.py", line 1121, in getsourcelines
    lines, lnum = findsource(object)
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/inspect.py", line 958, in findsource
    raise OSError('could not get source code')
OSError: could not get source code
, exit_code=1
2025-08-08 03:45:14,841 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:45:14,855 - openevolve.threaded_parallel - INFO - Iteration 3: Program 0c3e89ab-41b0-493b-b53e-e70674937193 (parent: 7b28180a-4479-44da-82f9-841c24420a2b) completed in 746.44s
2025-08-08 03:45:14,855 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=1.0000, stage=compile_error, compile_log=CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 173, in _verification_worker
    result: KernelExecResult = eval_kernel_against_ref(
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 578, in eval_kernel_against_ref
    graceful_eval_cleanup(context, device, tempfile)
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 230, in graceful_eval_cleanup
    torch.cuda.empty_cache()
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/cuda/memory.py", line 224, in empty_cache
    torch._C._cuda_emptyCache()
torch.AcceleratorError: CUDA error: an illegal memory access was encountered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

, exec_log=[Child] ç»‘å®š GPU 2, torch sees 1 device(s)

[Exception]
Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py", line 71, in _exec_worker
    exec(textwrap.dedent(code_src), mod.__dict__)
  File "<string>", line 10, in <module>
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 844, in jit
    return decorator(fn)
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 832, in decorator
    return JITFunction(
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 635, in __init__
    self.starting_line_number = inspect.getsourcelines(fn)[1]
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/inspect.py", line 1121, in getsourcelines
    lines, lnum = findsource(object)
  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/inspect.py", line 958, in findsource
    raise OSError('could not get source code')
OSError: could not get source code
, exit_code=1
2025-08-08 03:45:14,855 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 3
2025-08-08 03:45:14,856 - openevolve.database - INFO - Island Status:
2025-08-08 03:45:14,856 - openevolve.database - INFO -    Island 0: 5 programs, best=10.0000, avg=8.0000, diversity=343.82, gen=3 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 03:45:14,857 - openevolve.database - INFO -    Island 1: 2 programs, best=10.0000, avg=5.5000, diversity=633.50, gen=2 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 03:45:14,857 - openevolve.database - INFO -  * Island 2: 1 programs, best=10.0000, avg=10.0000, diversity=0.00, gen=2 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 03:45:14,945 - openevolve.database - INFO - Saved database with 8 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_3
2025-08-08 03:45:14,961 - openevolve.controller - INFO - Saved best program at checkpoint 3 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:45:14,961 - openevolve.controller - INFO - Saved checkpoint at iteration 3 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_3
2025-08-08 03:46:08,835 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:46:08,837 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5251 chars)
2025-08-08 03:46:12,023 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:46:12,024 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 03:46:12,024 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:46:12,024 - openevolve.evaluator - INFO - Evaluated program 27e493a1-7e2f-4a1a-979b-fb729e727ad1 in 3.19s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpa8i98bc8.py", line 97, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:46:12,026 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:46:12,031 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 8}
2025-08-08 03:46:12,043 - openevolve.threaded_parallel - INFO - Iteration 7: Program 27e493a1-7e2f-4a1a-979b-fb729e727ad1 (parent: 318249e1-d611-4dc4-9d29-05540ab8d0cb) completed in 413.56s
2025-08-08 03:46:12,043 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpa8i98bc8.py", line 97, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:95:\n    start_m = tl.program_id(0)\n    off_hz = tl.program_id(1)\n\n    off_z = off_hz // H\n    off_h = off_hz % H\n\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    q_ptrs = Q + q_offset + (start_m * BLOCK_M + tl.arange(0, BLOCK_M))[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                                                               ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:48:34,887 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:48:34,888 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3924 chars)
2025-08-08 03:48:38,094 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:48:38,094 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 03:48:38,094 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:48:38,095 - openevolve.evaluator - INFO - Evaluated program c4b261ef-d128-4570-b258-738d0381eeab in 3.21s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpmuvdjffw.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:28:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D: tl.constexpr, scale,  # Mark D as constexpr\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    # Use constexpr D for arange\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:48:38,099 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:48:38,109 - openevolve.threaded_parallel - INFO - Iteration 8: Program c4b261ef-d128-4570-b258-738d0381eeab (parent: 40aa2568-64cc-46cb-8820-e39340be1363) completed in 277.74s
2025-08-08 03:48:38,109 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpmuvdjffw.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:28:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D: tl.constexpr, scale,  # Mark D as constexpr\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    # Use constexpr D for arange\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:52:03,486 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:52:03,488 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(4041 chars)
2025-08-08 03:52:06,757 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:52:06,757 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:5","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmpjhd2z2pp.py\", line 90, in forward\n    _attn_kernel[grid](\n  
2025-08-08 03:52:06,757 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:52:06,758 - openevolve.evaluator - INFO - Evaluated program dce3c626-9e01-4b95-a605-809d8725053a in 3.27s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpjhd2z2pp.py", line 90, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 21:4:\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D_power2)  # Use power-of-two dimension here\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=offs_d < D, other=0.0)\n\n    acc = tl.zeros([D_power2], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:52:06,761 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:52:06,771 - openevolve.threaded_parallel - INFO - Iteration 10: Program dce3c626-9e01-4b95-a605-809d8725053a (parent: 0a428707-e8b3-461c-938e-d2888874459f) completed in 354.73s
2025-08-08 03:52:06,771 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpjhd2z2pp.py", line 90, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 21:4:\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D_power2)  # Use power-of-two dimension here\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=offs_d < D, other=0.0)\n\n    acc = tl.zeros([D_power2], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:54:06,393 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 03:54:06,395 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(4448 chars)
2025-08-08 03:54:10,113 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 03:54:10,113 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:5","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmp2nobx5yp.py\", line 102, in forward\n    _attn_kernel[grid](\n 
2025-08-08 03:54:10,113 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 03:54:10,114 - openevolve.evaluator - INFO - Evaluated program a4130090-9ec1-4049-b271-11c6a61ab5dd in 3.72s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2nobx5yp.py", line 102, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 27:4:\n\n    # Load query vector with head dimension mask\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    # Initialize accumulation and softmax state\n    acc = tl.zeros([BLOCK_D], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    # Process sequence in blocks\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:54:10,117 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:54:10,119 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 5}
2025-08-08 03:54:10,132 - openevolve.threaded_parallel - INFO - Iteration 9: Program a4130090-9ec1-4049-b271-11c6a61ab5dd (parent: e4667342-7683-48ef-8df0-e1cc272d3415) completed in 535.27s
2025-08-08 03:54:10,132 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2nobx5yp.py", line 102, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 27:4:\n\n    # Load query vector with head dimension mask\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    # Initialize accumulation and softmax state\n    acc = tl.zeros([BLOCK_D], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    # Process sequence in blocks\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:54:10,133 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 9
2025-08-08 03:54:10,134 - openevolve.database - INFO - Island Status:
2025-08-08 03:54:10,134 - openevolve.database - INFO -  * Island 0: 6 programs, best=10.0000, avg=8.3333, diversity=343.82, gen=5 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 03:54:10,134 - openevolve.database - INFO -    Island 1: 3 programs, best=10.0000, avg=7.0000, diversity=422.67, gen=3 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 03:54:10,134 - openevolve.database - INFO -    Island 2: 3 programs, best=10.0000, avg=10.0000, diversity=241.13, gen=3 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 03:54:10,303 - openevolve.database - INFO - Saved database with 12 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_9
2025-08-08 03:54:10,319 - openevolve.controller - INFO - Saved best program at checkpoint 9 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:54:10,319 - openevolve.controller - INFO - Saved checkpoint at iteration 9 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_9
2025-08-08 04:02:02,906 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:02:02,908 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3863 chars)
2025-08-08 04:02:06,213 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:02:06,214 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:7","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmp8p5m4zvt.py\", line 90, in forward\n    _attn_kernel[grid](\n  
2025-08-08 04:02:06,214 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:02:06,214 - openevolve.evaluator - INFO - Evaluated program deeb8204-adc1-4f01-befd-b152e6da58ba in 3.31s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp8p5m4zvt.py", line 90, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:4:\n    # Use power-of-two range (128) with mask for head dimension\n    offs_d = tl.arange(0, 128)\n    mask_d = offs_d < D\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    acc = tl.zeros([128], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:02:06,219 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:02:06,231 - openevolve.threaded_parallel - INFO - Iteration 12: Program deeb8204-adc1-4f01-befd-b152e6da58ba (parent: e4667342-7683-48ef-8df0-e1cc272d3415) completed in 599.45s
2025-08-08 04:02:06,231 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp8p5m4zvt.py", line 90, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 23:4:\n    # Use power-of-two range (128) with mask for head dimension\n    offs_d = tl.arange(0, 128)\n    mask_d = offs_d < D\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    acc = tl.zeros([128], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:02:06,232 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 12
2025-08-08 04:02:06,233 - openevolve.database - INFO - Island Status:
2025-08-08 04:02:06,233 - openevolve.database - INFO -    Island 0: 7 programs, best=10.0000, avg=8.5714, diversity=343.82, gen=5 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 04:02:06,233 - openevolve.database - INFO -  * Island 1: 3 programs, best=10.0000, avg=7.0000, diversity=422.67, gen=4 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 04:02:06,233 - openevolve.database - INFO -    Island 2: 3 programs, best=10.0000, avg=10.0000, diversity=241.13, gen=3 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 04:02:06,384 - openevolve.database - INFO - Saved database with 13 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_12
2025-08-08 04:02:06,400 - openevolve.controller - INFO - Saved best program at checkpoint 12 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:02:06,401 - openevolve.controller - INFO - Saved checkpoint at iteration 12 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_12
2025-08-08 04:03:20,868 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:03:20,870 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5374 chars)
2025-08-08 04:03:24,102 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:03:24,102 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 574, in arange\n    raise ValueError(\"arange's arguments must be of type tl.constexpr\")\nValueError: arange's arguments must be of type tl.constexpr\n\nThe above exception was the direct c
2025-08-08 04:03:24,102 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:03:24,103 - openevolve.evaluator - INFO - Evaluated program a1251b14-2e77-47e5-86e1-d97c1a103ea6 in 3.24s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpbl_6cpm0.py", line 126, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpbl_6cpm0.py", line 92, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 25:59:\n    off_h = off_hz % H\n\n    # Compute base pointers for current batch and head\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    # Initialize pointers and ranges for Q block\n    range_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)\n    mask_m = range_m < seq_len\n    q_ptrs = Q + q_offset + range_m[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                           ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:03:24,107 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:03:24,117 - openevolve.threaded_parallel - INFO - Iteration 11: Program a1251b14-2e77-47e5-86e1-d97c1a103ea6 (parent: 74c08639-5272-4781-8f38-ce1ab5b3ad84) completed in 886.00s
2025-08-08 04:03:24,118 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpbl_6cpm0.py", line 126, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpbl_6cpm0.py", line 92, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 25:59:\n    off_h = off_hz % H\n\n    # Compute base pointers for current batch and head\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    # Initialize pointers and ranges for Q block\n    range_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)\n    mask_m = range_m < seq_len\n    q_ptrs = Q + q_offset + range_m[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                           ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:04:28,393 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:04:28,394 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3853 chars)
2025-08-08 04:04:31,625 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:04:31,626 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 574, in arange\n    raise ValueError(\"arange's arguments must be of type tl.constexpr\")\nValueError: arange's arguments must be of type tl.constexpr\n\nThe above exception was the direct c
2025-08-08 04:04:31,626 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:04:31,626 - openevolve.evaluator - INFO - Evaluated program d080a2c4-e0db-4556-9e63-0ac24ca8ff88 in 3.24s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp6xqzw8mp.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:13:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    D_rounded = 128  # Nearest power of two >=96\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D_rounded)\n             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:04:31,631 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:04:31,642 - openevolve.threaded_parallel - INFO - Iteration 13: Program d080a2c4-e0db-4556-9e63-0ac24ca8ff88 (parent: 0a428707-e8b3-461c-938e-d2888874459f) completed in 621.51s
2025-08-08 04:04:31,642 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp6xqzw8mp.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 13:13:\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, scale,\n    D: tl.constexpr,\n    BLOCK: tl.constexpr,\n):\n    D_rounded = 128  # Nearest power of two >=96\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    offs_d = tl.arange(0, D_rounded)\n             ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:09:18,100 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:09:18,102 - openevolve.evaluator - INFO - Evaluated program c9df666b-4d90-4b81-a3ce-059d5cd59a13 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:09:18,106 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:09:18,109 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 0}
2025-08-08 04:09:18,116 - openevolve.threaded_parallel - INFO - Iteration 15: Program c9df666b-4d90-4b81-a3ce-059d5cd59a13 (parent: 0c3e89ab-41b0-493b-b53e-e70674937193) completed in 353.99s
2025-08-08 04:09:18,117 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:09:18,117 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 15
2025-08-08 04:09:18,119 - openevolve.database - INFO - Island Status:
2025-08-08 04:09:18,119 - openevolve.database - INFO -    Island 0: 8 programs, best=10.0000, avg=-5.0000, diversity=343.82, gen=6 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 04:09:18,119 - openevolve.database - INFO -  * Island 1: 4 programs, best=10.0000, avg=7.7500, diversity=391.72, gen=5 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 04:09:18,119 - openevolve.database - INFO -    Island 2: 4 programs, best=10.0000, avg=10.0000, diversity=212.85, gen=4 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 04:09:18,297 - openevolve.database - INFO - Saved database with 16 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_15
2025-08-08 04:09:18,311 - openevolve.controller - INFO - Saved best program at checkpoint 15 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:09:18,311 - openevolve.controller - INFO - Saved checkpoint at iteration 15 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_15
2025-08-08 04:10:39,877 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:10:39,879 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(18419 chars)
2025-08-08 04:10:42,197 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:10:42,198 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":false,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","compilation_error_name":"builtins.SyntaxError","compilation_error":"unterminated string literal (detected at line 11) (tmpt9v5i1dw.py, line 11)","reference_timing_ms":0.318,"speed_up":-1.0,"custom_timing":-1.0},"runtime":-1.0,"runtime_stats":{}}}
2025-08-08 04:10:42,198 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ compile_error
2025-08-08 04:10:42,198 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_2e16e1] execute payload: {id:level3_43_MinGPTCausalAttention_2e16e1, device_type:NV_LY_20}
2025-08-08 04:10:44,180 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_2e16e1] execute request success
2025-08-08 04:10:44,180 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention_2e16e1] execute response: {"id":"level3_43_MinGPTCausalAttention_2e16e1","exit_code":"1","content":"[Child] ç»‘å®š GPU 3, torch sees 1 device(s)\n\n[Exception]\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py\", line 71, in _exec_worker\n    exec(textwrap.dedent(code_src), mod.__dict__)\n  File \"<string>\", line 11\n    1. Compute the next power of two for the head dimension (D) and pass it as a constexpr (let's call it P2).\n                                                                                               ^\nSyntaxError: unterminated string literal (detected at line 11)\n"}
2025-08-08 04:10:44,181 - openevolve.evaluator - INFO - Evaluated program 7f235c57-6d3f-476b-9191-dbfa62a713e2 in 4.30s: compiled=0.0000, correctness=0.0000, score=1.0000, stage=compile_error, compile_log=, exec_log=[Child] ç»‘å®š GPU 3, torch sees 1 device(s)

[Exception]
Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py", line 71, in _exec_worker
    exec(textwrap.dedent(code_src), mod.__dict__)
  File "<string>", line 11
    1. Compute the next power of two for the head dimension (D) and pass it as a constexpr (let's call it P2).
                                                                                               ^
SyntaxError: unterminated string literal (detected at line 11)
, exit_code=1
2025-08-08 04:10:44,185 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:10:44,196 - openevolve.threaded_parallel - INFO - Iteration 14: Program 7f235c57-6d3f-476b-9191-dbfa62a713e2 (parent: c4b261ef-d128-4570-b258-738d0381eeab) completed in 517.96s
2025-08-08 04:10:44,196 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=1.0000, stage=compile_error, compile_log=, exec_log=[Child] ç»‘å®š GPU 3, torch sees 1 device(s)

[Exception]
Traceback (most recent call last):
  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/code_executor.py", line 71, in _exec_worker
    exec(textwrap.dedent(code_src), mod.__dict__)
  File "<string>", line 11
    1. Compute the next power of two for the head dimension (D) and pass it as a constexpr (let's call it P2).
                                                                                               ^
SyntaxError: unterminated string literal (detected at line 11)
, exit_code=1
2025-08-08 04:12:19,177 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:12:19,179 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5817 chars)
2025-08-08 04:12:24,791 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:12:24,791 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","max_difference":["nan","nan","nan","nan","nan"],"avg_difference":["nan","nan","nan","nan","nan"],"correctness_issue":"Output mismatch","correctness_trials":"(0 / 5)","reference_timing_ms":0.318,"speed_up":-1.0,"custom_timing":-1.0},"runtime":-1.0,"runtime_stats":{}}}
2025-08-08 04:12:24,791 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:12:24,792 - openevolve.evaluator - INFO - Evaluated program c6375745-5d18-4812-8fcb-17fae517c3aa in 5.62s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'max_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'avg_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:12:24,796 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:12:24,814 - openevolve.threaded_parallel - INFO - Iteration 16: Program c6375745-5d18-4812-8fcb-17fae517c3aa (parent: 27e493a1-7e2f-4a1a-979b-fb729e727ad1) completed in 473.16s
2025-08-08 04:12:24,814 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'max_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'avg_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:14:41,287 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:14:41,288 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3850 chars)
2025-08-08 04:14:44,976 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:14:44,977 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmpj_tp9_a_.py\", line 89, in forward\n    _attn_kernel[grid](\n  
2025-08-08 04:14:44,977 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:14:44,977 - openevolve.evaluator - INFO - Evaluated program 72e3d3fa-6b11-4e09-968c-1293665e3253 in 3.69s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpj_tp9_a_.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 22:4:\n    # Use fixed power-of-two dimension (128) with mask\n    offs_d = tl.arange(0, 128)\n    mask_d = offs_d < D\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    acc = tl.zeros([128], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:14:44,982 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:14:44,988 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 1}
2025-08-08 04:14:45,000 - openevolve.threaded_parallel - INFO - Iteration 17: Program 72e3d3fa-6b11-4e09-968c-1293665e3253 (parent: 40aa2568-64cc-46cb-8820-e39340be1363) completed in 326.87s
2025-08-08 04:14:45,000 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpj_tp9_a_.py", line 89, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 22:4:\n    # Use fixed power-of-two dimension (128) with mask\n    offs_d = tl.arange(0, 128)\n    mask_d = offs_d < D\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + offs_d * stride_d, mask=mask_d, other=0.0)\n\n    acc = tl.zeros([128], dtype=tl.float32)\n    max_score = tl.full((1,), float(\'-inf\'), dtype=tl.float32)\n    normalizer = 0.0\n\n    for j in range(0, pid_row + 1, BLOCK):\n    ^\nAssertionError("Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.")\n\n\nThe above exception was the direct cause of the following exception:\n\nAssertionError: Loop-carried variable normalizer has initial type fp32 but is re-assigned to <[\'1\'], fp32> in loop! Please make sure that the type stays consistent.\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:18:12,670 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:18:12,671 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5243 chars)
2025-08-08 04:18:16,068 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:18:16,068 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:6","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 1654, in arange\n    return _semantic.arange(start, end)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 583, in arange\n    raise ValueError(\"arange's range must be a power of 2\")\nValueError: arange's range must be a power of 2\n\nThe above exception was the direct cause of the following ex
2025-08-08 04:18:16,069 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:18:16,069 - openevolve.evaluator - INFO - Evaluated program ca5ac967-0f1d-4d52-bdb2-2ed2dcbedabe in 3.40s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpa_rqxgf7.py", line 126, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpa_rqxgf7.py", line 92, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 25:59:\n    off_h = off_hz % H\n\n    # Compute base pointers for current batch and head\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    # Initialize pointers and ranges for Q block\n    range_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)\n    mask_m = range_m < seq_len\n    q_ptrs = Q + q_offset + range_m[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                           ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:18:16,072 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 2}
2025-08-08 04:18:16,074 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:18:16,087 - openevolve.threaded_parallel - INFO - Iteration 18: Program ca5ac967-0f1d-4d52-bdb2-2ed2dcbedabe (parent: a1251b14-2e77-47e5-86e1-d97c1a103ea6) completed in 451.88s
2025-08-08 04:18:16,087 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpa_rqxgf7.py", line 126, in forward\n    y = attention(q, k, v, causal=True, sm_scale=scale)\n  File "/tmp/tmpa_rqxgf7.py", line 92, in attention\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 25:59:\n    off_h = off_hz % H\n\n    # Compute base pointers for current batch and head\n    q_offset = off_z * stride_qz + off_h * stride_qh\n    k_offset = off_z * stride_kz + off_h * stride_kh\n    v_offset = off_z * stride_vz + off_h * stride_vh\n    o_offset = off_z * stride_oz + off_h * stride_oh\n\n    # Initialize pointers and ranges for Q block\n    range_m = start_m * BLOCK_M + tl.arange(0, BLOCK_M)\n    mask_m = range_m < seq_len\n    q_ptrs = Q + q_offset + range_m[:, None] * stride_qm + tl.arange(0, D_HEAD)[None, :] * stride_qk\n                                                           ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 583, in arange\n    raise ValueError("arange\'s range must be a power of 2")\nValueError: arange\'s range must be a power of 2\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:18:16,087 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 18
2025-08-08 04:18:16,089 - openevolve.database - INFO - Island Status:
2025-08-08 04:18:16,090 - openevolve.database - INFO -    Island 0: 9 programs, best=10.0000, avg=-3.3333, diversity=272.83, gen=7 (best: 40aa2568-64cc-46cb-8820-e39340be1363)
2025-08-08 04:18:16,090 - openevolve.database - INFO -    Island 1: 6 programs, best=10.0000, avg=7.0000, diversity=2151.25, gen=6 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 04:18:16,090 - openevolve.database - INFO -  * Island 2: 5 programs, best=10.0000, avg=10.0000, diversity=254.37, gen=6 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 04:18:16,363 - openevolve.database - INFO - Saved database with 20 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_18
2025-08-08 04:18:16,380 - openevolve.controller - INFO - Saved best program at checkpoint 18 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpvqyo3218.py", line 85, in forward\n    _attn_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 12:28:\ndef _attn_kernel(\n    q_ptr, k_ptr, v_ptr, o_ptr,\n    stride_b, stride_t, stride_d,\n    T, D, scale,\n    BLOCK: tl.constexpr,\n):\n    pid = tl.program_id(0)\n    pid_batch = pid // T\n    pid_row = pid % T\n\n    q_row_ptr = q_ptr + pid_batch * stride_b + pid_row * stride_t\n    q = tl.load(q_row_ptr + tl.arange(0, D) * stride_d)\n                            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1654, in arange\n    return _semantic.arange(start, end)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 574, in arange\n    raise ValueError("arange\'s arguments must be of type tl.constexpr")\nValueError: arange\'s arguments must be of type tl.constexpr\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:18:16,380 - openevolve.controller - INFO - Saved checkpoint at iteration 18 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_18
2025-08-08 04:20:03,098 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:20:03,100 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5665 chars)
2025-08-08 04:20:08,465 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:20:08,465 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","max_difference":["nan","nan","nan","nan","nan"],"avg_difference":["nan","nan","nan","nan","nan"],"correctness_issue":"Output mismatch","correctness_trials":"(0 / 5)","reference_timing_ms":0.318,"speed_up":-1.0,"custom_timing":-1.0},"runtime":-1.0,"runtime_stats":{}}}
2025-08-08 04:20:08,466 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ wrong_answer
2025-08-08 04:20:08,466 - openevolve.evaluator - INFO - Evaluated program c701a27a-646b-4ff2-9334-05e2cc68b975 in 5.37s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'max_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'avg_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:20:08,471 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:20:08,484 - openevolve.threaded_parallel - INFO - Iteration 19: Program c701a27a-646b-4ff2-9334-05e2cc68b975 (parent: 27e493a1-7e2f-4a1a-979b-fb729e727ad1) completed in 463.67s
2025-08-08 04:20:08,484 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_43_MinGPTCausalAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'max_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'avg_difference': ['nan', 'nan', 'nan', 'nan', 'nan'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.318, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:22:35,021 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:22:35,023 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(4520 chars)
2025-08-08 04:22:45,104 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:22:45,104 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.012,"custom_timing":25.7},"runtime":25.7,"runtime_stats":{"mean":25.7,"std":0.127,"min":25.6,"max":26.6,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:2"}}}
2025-08-08 04:22:45,104 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.012  score=20.00
2025-08-08 04:22:45,105 - openevolve.evaluator - INFO - Evaluated program b46384eb-aa8d-49c9-8f6a-3734705ac9fe in 10.17s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:22:45,110 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:22:45,115 - openevolve.database - INFO - MAP-Elites cell improved: {'score': 9, 'complexity': 2} (fitness: 10.000 -> 20.000)
2025-08-08 04:22:45,115 - openevolve.database - INFO - New best program b46384eb-aa8d-49c9-8f6a-3734705ac9fe replaces 40aa2568-64cc-46cb-8820-e39340be1363
2025-08-08 04:22:45,127 - openevolve.threaded_parallel - INFO - Iteration 21: Program b46384eb-aa8d-49c9-8f6a-3734705ac9fe (parent: dce3c626-9e01-4b95-a605-809d8725053a) completed in 269.03s
2025-08-08 04:22:45,128 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:22:45,128 - openevolve.threaded_parallel - INFO - ðŸŒŸ New best solution found at iteration 21: b46384eb-aa8d-49c9-8f6a-3734705ac9fe
2025-08-08 04:22:45,128 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 21
2025-08-08 04:22:45,130 - openevolve.database - INFO - Island Status:
2025-08-08 04:22:45,130 - openevolve.database - INFO -    Island 0: 10 programs, best=20.0000, avg=-1.0000, diversity=272.83, gen=8 (best: b46384eb-aa8d-49c9-8f6a-3734705ac9fe)
2025-08-08 04:22:45,130 - openevolve.database - INFO -  * Island 1: 6 programs, best=10.0000, avg=7.0000, diversity=2151.25, gen=7 (best: e4667342-7683-48ef-8df0-e1cc272d3415)
2025-08-08 04:22:45,130 - openevolve.database - INFO -    Island 2: 6 programs, best=10.0000, avg=10.0000, diversity=339.90, gen=6 (best: 0a428707-e8b3-461c-938e-d2888874459f)
2025-08-08 04:22:45,470 - openevolve.database - INFO - Saved database with 22 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_21
2025-08-08 04:22:45,487 - openevolve.controller - INFO - Saved best program at checkpoint 21 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:22:45,487 - openevolve.controller - INFO - Saved checkpoint at iteration 21 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_21
2025-08-08 04:23:04,024 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:23:04,025 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3922 chars)
2025-08-08 04:23:11,844 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:23:11,846 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.012,"custom_timing":25.6},"runtime":25.6,"runtime_stats":{"mean":25.6,"std":0.0378,"min":25.5,"max":25.7,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:0"}}}
2025-08-08 04:23:11,846 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.012  score=20.00
2025-08-08 04:23:11,847 - openevolve.evaluator - INFO - Evaluated program 41303933-ca07-406a-acbf-021494fc2b2f in 7.82s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:23:11,851 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:23:11,897 - openevolve.threaded_parallel - INFO - Iteration 20: Program 41303933-ca07-406a-acbf-021494fc2b2f (parent: deeb8204-adc1-4f01-befd-b152e6da58ba) completed in 506.87s
2025-08-08 04:23:11,898 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:26:15,667 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:26:15,669 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3906 chars)
2025-08-08 04:26:23,128 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:26:23,128 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.012,"custom_timing":25.6},"runtime":25.6,"runtime_stats":{"mean":25.6,"std":0.0344,"min":25.6,"max":25.7,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:4"}}}
2025-08-08 04:26:23,128 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.012  score=20.00
2025-08-08 04:26:23,129 - openevolve.evaluator - INFO - Evaluated program 004087ab-2133-42ed-ad32-ef38de6e9030 in 7.46s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:26:23,133 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:26:23,149 - openevolve.threaded_parallel - INFO - Iteration 22: Program 004087ab-2133-42ed-ad32-ef38de6e9030 (parent: a4130090-9ec1-4049-b271-11c6a61ab5dd) completed in 374.66s
2025-08-08 04:26:23,149 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:27:26,147 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:27:26,149 - openevolve.evaluator - INFO - Evaluated program 647a6de6-41bb-4bf6-9c63-22f988f12f37 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:27:26,154 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:27:26,155 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 4}
2025-08-08 04:27:26,155 - openevolve.database - INFO - MAP-Elites coverage reached 10.0% (10/100 cells)
2025-08-08 04:27:26,196 - openevolve.threaded_parallel - INFO - Iteration 24: Program 647a6de6-41bb-4bf6-9c63-22f988f12f37 (parent: 7f235c57-6d3f-476b-9191-dbfa62a713e2) completed in 254.30s
2025-08-08 04:27:26,196 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:27:26,196 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 24
2025-08-08 04:27:26,199 - openevolve.database - INFO - Island Status:
2025-08-08 04:27:26,199 - openevolve.database - INFO -    Island 0: 11 programs, best=20.0000, avg=-10.0000, diversity=467.03, gen=9 (best: b46384eb-aa8d-49c9-8f6a-3734705ac9fe)
2025-08-08 04:27:26,199 - openevolve.database - INFO -  * Island 1: 7 programs, best=20.0000, avg=8.8571, diversity=1625.53, gen=8 (best: 41303933-ca07-406a-acbf-021494fc2b2f)
2025-08-08 04:27:26,199 - openevolve.database - INFO -    Island 2: 7 programs, best=20.0000, avg=11.4286, diversity=269.93, gen=7 (best: 004087ab-2133-42ed-ad32-ef38de6e9030)
2025-08-08 04:27:26,510 - openevolve.database - INFO - Saved database with 25 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_24
2025-08-08 04:27:26,526 - openevolve.controller - INFO - Saved best program at checkpoint 24 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:27:26,526 - openevolve.controller - INFO - Saved checkpoint at iteration 24 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_24
2025-08-08 04:30:56,892 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:30:56,894 - openevolve.evaluator - INFO - Evaluated program fc2497f5-01ab-4f5e-b263-6a58dcaf1096 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:30:56,898 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 9}
2025-08-08 04:30:56,898 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:30:56,898 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:30:56,899 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:30:56,912 - openevolve.threaded_parallel - INFO - Iteration 23: Program fc2497f5-01ab-4f5e-b263-6a58dcaf1096 (parent: 34bfe864-b5e0-4b29-8f8e-4f4798256f5f) completed in 491.78s
2025-08-08 04:30:56,912 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:31:08,444 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:31:08,444 - openevolve.evaluator - INFO - Evaluated program 6dde7933-d9cc-4f18-8b46-cdc25f9a8537 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:31:08,447 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 0}
2025-08-08 04:31:08,447 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:31:08,447 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:31:08,448 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:31:08,459 - openevolve.threaded_parallel - INFO - Iteration 25: Program 6dde7933-d9cc-4f18-8b46-cdc25f9a8537 (parent: 27e493a1-7e2f-4a1a-979b-fb729e727ad1) completed in 285.31s
2025-08-08 04:31:08,459 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:39:51,652 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:39:51,654 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(5299 chars)
2025-08-08 04:39:57,613 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:39:57,613 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.042,"custom_timing":7.65},"runtime":7.65,"runtime_stats":{"mean":7.65,"std":0.0258,"min":7.63,"max":7.75,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:3"}}}
2025-08-08 04:39:57,613 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.042  score=20.00
2025-08-08 04:39:57,614 - openevolve.evaluator - INFO - Evaluated program 0ba92b38-1bcd-4c3a-b0cd-415d09807320 in 5.96s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0420, runtime_ms=7.6500, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.042, 'custom_timing': 7.65}
2025-08-08 04:39:57,617 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:39:57,617 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:39:57,619 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:39:57,630 - openevolve.threaded_parallel - INFO - Iteration 26: Program 0ba92b38-1bcd-4c3a-b0cd-415d09807320 (parent: 34bfe864-b5e0-4b29-8f8e-4f4798256f5f) completed in 751.46s
2025-08-08 04:39:57,630 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0420, runtime_ms=7.6500, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.042, 'custom_timing': 7.65}
2025-08-08 04:40:28,661 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:40:28,663 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(3901 chars)
2025-08-08 04:40:36,232 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:40:36,232 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.012,"custom_timing":25.6},"runtime":25.6,"runtime_stats":{"mean":25.6,"std":0.0879,"min":25.6,"max":26.4,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:4"}}}
2025-08-08 04:40:36,233 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.012  score=20.00
2025-08-08 04:40:36,233 - openevolve.evaluator - INFO - Evaluated program 644d5477-4d26-4aae-bd0c-9acafec06fe1 in 7.57s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:40:36,241 - openevolve.database - INFO - MAP-Elites cell improved: {'score': 9, 'complexity': 1} (fitness: 10.000 -> 20.000)
2025-08-08 04:40:36,242 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:40:36,242 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:40:36,254 - openevolve.threaded_parallel - INFO - Iteration 27: Program 644d5477-4d26-4aae-bd0c-9acafec06fe1 (parent: dce3c626-9e01-4b95-a605-809d8725053a) completed in 579.33s
2025-08-08 04:40:36,254 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.6000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.6}
2025-08-08 04:40:36,254 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 27
2025-08-08 04:40:36,257 - openevolve.database - INFO - Island Status:
2025-08-08 04:40:36,257 - openevolve.database - INFO -    Island 0: 10 programs, best=20.0000, avg=11.0000, diversity=238.05, gen=10 (best: b46384eb-aa8d-49c9-8f6a-3734705ac9fe)
2025-08-08 04:40:36,257 - openevolve.database - INFO -    Island 1: 8 programs, best=20.0000, avg=10.2500, diversity=1623.63, gen=9 (best: 41303933-ca07-406a-acbf-021494fc2b2f)
2025-08-08 04:40:36,257 - openevolve.database - INFO -  * Island 2: 7 programs, best=20.0000, avg=11.4286, diversity=269.93, gen=9 (best: 004087ab-2133-42ed-ad32-ef38de6e9030)
2025-08-08 04:40:36,593 - openevolve.database - INFO - Saved database with 25 programs to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_27
2025-08-08 04:40:36,610 - openevolve.controller - INFO - Saved best program at checkpoint 27 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:40:36,610 - openevolve.controller - INFO - Saved checkpoint at iteration 27 to openevolve_output/level3_43_MinGPTCausalAttention/checkpoints/checkpoint_27
2025-08-08 04:44:05,514 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] triton key words check pass
2025-08-08 04:44:05,516 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus payload: reference_code(2615 chars) + custom_code(4468 chars)
2025-08-08 04:44:13,002 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus request success
2025-08-08 04:44:13,003 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] verify_plus response: {"id":"level3_43_MinGPTCausalAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:7","correctness_trials":"(5 / 5)","reference_timing_ms":0.318,"speed_up":0.012,"custom_timing":25.7},"runtime":25.7,"runtime_stats":{"mean":25.7,"std":0.013,"min":25.7,"max":25.9,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:7"}}}
2025-08-08 04:44:13,003 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ” success | speed_up=0.012  score=20.00
2025-08-08 04:44:13,003 - openevolve.evaluator - INFO - Evaluated program 83568f1c-d3f7-4708-8d50-dfbe2260fb88 in 7.49s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:44:13,009 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:44:13,009 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:44:13,022 - openevolve.threaded_parallel - INFO - Iteration 29: Program 83568f1c-d3f7-4708-8d50-dfbe2260fb88 (parent: c4b261ef-d128-4570-b258-738d0381eeab) completed in 255.38s
2025-08-08 04:44:13,022 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:44:24,983 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_43_MinGPTCausalAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:44:24,983 - openevolve.evaluator - INFO - Evaluated program 541035e3-2783-4944-b0ca-52b5e8e44c90 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:44:24,986 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 0}
2025-08-08 04:44:24,986 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:44:24,987 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:44:24,999 - openevolve.threaded_parallel - INFO - Iteration 28: Program 541035e3-2783-4944-b0ca-52b5e8e44c90 (parent: 27e493a1-7e2f-4a1a-979b-fb729e727ad1) completed in 796.54s
2025-08-08 04:44:24,999 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:44:25,000 - openevolve.threaded_parallel - INFO - Evolution completed
2025-08-08 04:44:25,008 - openevolve.threaded_parallel - INFO - Stopped thread pool
2025-08-08 04:44:25,008 - openevolve.threaded_parallel - INFO - Stopped improved parallel controller
2025-08-08 04:44:25,008 - openevolve.controller - INFO - Using tracked best program: b46384eb-aa8d-49c9-8f6a-3734705ac9fe
2025-08-08 04:44:25,008 - openevolve.controller - INFO - Evolution complete. Best program has metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0120, runtime_ms=25.7000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.318, 'speed_up': 0.012, 'custom_timing': 25.7}
2025-08-08 04:44:25,025 - openevolve.controller - INFO - Saved best program to openevolve_output/level3_43_MinGPTCausalAttention/best/best_program.py with program info to openevolve_output/level3_43_MinGPTCausalAttention/best/best_program_info.json
2025-08-08 04:44:25,026 - __main__ - INFO - âœ… å®Œæˆ level3_43_MinGPTCausalAttention
2025-08-08 04:44:25,026 - __main__ - INFO - ======================================================================
2025-08-08 04:44:25,026 - __main__ - INFO - ðŸš€ [6/6] å¼€å§‹ level4_6_facebook-bart-large_bs1_seq1023
2025-08-08 04:44:25,026 - __main__ - INFO - ======================================================================
2025-08-08 04:44:25,079 - openevolve.controller - INFO - Logging to openevolve_output/level4_6_facebook-bart-large_bs1_seq1023/logs/openevolve_20250808_044425.log
2025-08-08 04:44:25,079 - openevolve.controller - INFO - Set random seed to 42 for reproducibility
2025-08-08 04:44:25,118 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 04:44:25,157 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 04:44:25,157 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 04:44:25,157 - openevolve.database - INFO - Initialized program database with 0 programs
2025-08-08 04:44:25,177 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level4_6_facebook-bart-large_bs1_seq1023/evaluation.py
2025-08-08 04:44:25,177 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level4_6_facebook-bart-large_bs1_seq1023/evaluation.py
2025-08-08 04:44:25,177 - openevolve.controller - INFO - Initialized OpenEvolve with /tmp/e07f3df9631b2045d31ffe34f4f6068a.py
2025-08-08 04:44:25,178 - openevolve.controller - INFO - Adding initial program to database
2025-08-08 04:44:25,179 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus payload: reference_code(718 chars) + custom_code(839 chars)
2025-08-08 04:44:27,590 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus request success
2025-08-08 04:44:27,591 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus response: {"id":"level4_6_facebook-bart-large_bs1_seq1023","result":{"error":"No module named 'transformers'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 3, in <module>\nModuleNotFoundError: No module named 'transformers'\n"}}
2025-08-08 04:44:27,591 - openevolve.evaluator - WARNING - Evaluation attempt 1/4 failed for program 37165c20-407f-4325-a8a3-0b74aad8a29f: Error: The reference code is not valid or correct. The verify result is: {'error': 'No module named \'transformers\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 3, in <module>\nModuleNotFoundError: No module named \'transformers\'\n'}
2025-08-08 04:44:28,598 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus payload: reference_code(718 chars) + custom_code(839 chars)
2025-08-08 04:44:30,823 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus request success
2025-08-08 04:44:30,824 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus response: {"id":"level4_6_facebook-bart-large_bs1_seq1023","result":{"error":"No module named 'transformers'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 3, in <module>\nModuleNotFoundError: No module named 'transformers'\n"}}
2025-08-08 04:44:30,824 - openevolve.evaluator - WARNING - Evaluation attempt 2/4 failed for program 37165c20-407f-4325-a8a3-0b74aad8a29f: Error: The reference code is not valid or correct. The verify result is: {'error': 'No module named \'transformers\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 3, in <module>\nModuleNotFoundError: No module named \'transformers\'\n'}
2025-08-08 04:44:31,827 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus payload: reference_code(718 chars) + custom_code(839 chars)
2025-08-08 04:44:34,114 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus request success
2025-08-08 04:44:34,114 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus response: {"id":"level4_6_facebook-bart-large_bs1_seq1023","result":{"error":"No module named 'transformers'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 3, in <module>\nModuleNotFoundError: No module named 'transformers'\n"}}
2025-08-08 04:44:34,114 - openevolve.evaluator - WARNING - Evaluation attempt 3/4 failed for program 37165c20-407f-4325-a8a3-0b74aad8a29f: Error: The reference code is not valid or correct. The verify result is: {'error': 'No module named \'transformers\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 3, in <module>\nModuleNotFoundError: No module named \'transformers\'\n'}
2025-08-08 04:44:35,117 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus payload: reference_code(718 chars) + custom_code(839 chars)
2025-08-08 04:44:37,462 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus request success
2025-08-08 04:44:37,464 - openevolve.RemoteSpeedupEvaluator - INFO - [level4_6_facebook-bart-large_bs1_seq1023] verify_plus response: {"id":"level4_6_facebook-bart-large_bs1_seq1023","result":{"error":"No module named 'transformers'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 3, in <module>\nModuleNotFoundError: No module named 'transformers'\n"}}
2025-08-08 04:44:37,465 - openevolve.evaluator - WARNING - Evaluation attempt 4/4 failed for program 37165c20-407f-4325-a8a3-0b74aad8a29f: Error: The reference code is not valid or correct. The verify result is: {'error': 'No module named \'transformers\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 3, in <module>\nModuleNotFoundError: No module named \'transformers\'\n'}
2025-08-08 04:44:37,465 - openevolve.evaluator - ERROR - All evaluation attempts failed for program 37165c20-407f-4325-a8a3-0b74aad8a29f. Last error: Error: The reference code is not valid or correct. The verify result is: {'error': 'No module named \'transformers\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 3, in <module>\nModuleNotFoundError: No module named \'transformers\'\n'}
2025-08-08 04:44:37,466 - __main__ - ERROR - ðŸ’¥ å¤±è´¥ level4_6_facebook-bart-large_bs1_seq1023: 'score'
2025-08-08 04:44:37,466 - __main__ - INFO - ----------------------------------------------------------------------
2025-08-08 04:44:37,466 - __main__ - INFO - ðŸ“Š è¿›ç¨‹ rank=16 ç»“æŸ | æˆåŠŸ 5 | å¤±è´¥ 1
2025-08-08 04:44:37,466 - __main__ - INFO - ----------------------------------------------------------------------
