{"id": "1a8f6d68-9b7e-4988-98bf-429f9454a8e0", "code": "@triton.jit\ndef max_pool3d_kernel(\n    input_ptr,\n    output_ptr,\n    # Tensor dimensions\n    B, C, D, H, W,\n    D_out, H_out, W_out,\n    # Input tensor strides\n    input_stride_b, input_stride_c, input_stride_d, input_stride_h, input_stride_w,\n    # Output tensor strides\n    output_stride_b, output_stride_c, output_stride_d, output_stride_h, output_stride_w,\n    # Pooling parameters\n    kernel_d, kernel_h, kernel_w,\n    stride_d, stride_h, stride_w,\n    padding_d, padding_h, padding_w,\n    dilation_d, dilation_h, dilation_w,\n    # Block size (unused in this implementation but kept for compatibility)\n    BLOCK_SIZE: tl.constexpr\n):\n    # Program indices\n    pid_b = tl.program_id(0)\n    pid_c = tl.program_id(1)\n    pid_s = tl.program_id(2)\n    \n    # Decompose spatial index\n    hw_size = H_out * W_out\n    d_out = pid_s // hw_size\n    hw = pid_s % hw_size\n    h_out = hw // W_out\n    w_out = hw % W_out\n\n    # Check bounds\n    if pid_b >= B or pid_c >= C or d_out >= D_out or h_out >= H_out or w_out >= W_out:\n        return\n\n    # Calculate starting indices\n    start_d = d_out * stride_d - padding_d\n    start_h = h_out * stride_h - padding_h\n    start_w = w_out * stride_w - padding_w\n    \n    # Precompute base offset\n    base_offset = pid_b * input_stride_b + pid_c * input_stride_c\n    max_val = float('-inf')\n    \n    # Optimized for common kernel size 3x3x3\n    if kernel_d == 3 and kernel_h == 3 and kernel_w == 3:\n        # Unroll loops for 3x3x3 case\n        for kd in tl.static_range(0, 3):\n            d_in = start_d + kd * dilation_d\n            d_in_bound = (d_in >= 0) & (d_in < D)\n            for kh in tl.static_range(0, 3):\n                h_in = start_h + kh * dilation_h\n                h_in_bound = d_in_bound & (h_in >= 0) & (h_in < H)\n                for kw in tl.static_range(0, 3):\n                    w_in = start_w + kw * dilation_w\n                    in_bounds = h_in_bound & (w_in >= 0) & (w_in < W)\n                    \n                    # Compute offset and load with mask\n                    offset = base_offset + d_in * input_stride_d + h_in * input_stride_h + w_in * input_stride_w\n                    val = tl.load(input_ptr + offset, mask=in_bounds, other=float('-inf'))\n                    max_val = tl.maximum(max_val, val)\n    else:\n        # Generic kernel size handling\n        for kd in range(0, kernel_d):\n            d_in = start_d + kd * dilation_d\n            d_in_bound = (d_in >= 0) & (d_in < D)\n            for kh in range(0, kernel_h):\n                h_in = start_h + kh * dilation_h\n                h_in_bound = d_in_bound & (h_in >= 0) & (h_in < H)\n                for kw in range(0, kernel_w):\n                    w_in = start_w + kw * dilation_w\n                    in_bounds = h_in_bound & (w_in >= 0) & (w_in < W)\n                    \n                    # Compute offset and load with mask\n                    offset = base_offset + d_in * input_stride_d + h_in * input_stride_h + w_in * input_stride_w\n                    val = tl.load(input_ptr + offset, mask=in_bounds, other=float('-inf'))\n                    max_val = tl.maximum(max_val, val)\n    \n    # Calculate output offset\n    out_offset = (\n        pid_b * output_stride_b + \n        pid_c * output_stride_c + \n        d_out * output_stride_d + \n        h_out * output_stride_h + \n        w_out * output_stride_w\n    )\n    \n    # Store result\n    tl.store(output_ptr + out_offset, max_val)", "language": "python", "parent_id": "48a43dd4-345c-40be-bd4f-c676b7d4e7f1", "generation": 2, "timestamp": 1754645821.92826, "iteration_found": 23, "metrics": {"compiled": false, "correctness": false, "score": -100.0, "stage": "no_valid_triton_code", "feedback": "You need to generate real and valid triton code for the core function. The key word 'import triton' is not found."}, "complexity": 0.0, "diversity": 0.0, "metadata": {"changes": "Full rewrite", "parent_metrics": {"compiled": true, "correctness": true, "stage": "success", "passed": false, "score": 20, "speed_up": 0.018, "runtime_ms": 26.9, "meta": {"hardware": "NVIDIA L20Y", "device": "cuda:3", "correctness_trials": "(5 / 5)", "reference_timing_ms": 0.487, "speed_up": 0.018, "custom_timing": 26.9}}, "island": 0}, "artifacts_json": null, "artifact_dir": null}