2025-08-08 02:44:03,795 - openevolve.controller - INFO - Logging to openevolve_output/level3_50_ReLUSelfAttention/logs/openevolve_20250808_024403.log
2025-08-08 02:44:03,796 - openevolve.controller - INFO - Set random seed to 42 for reproducibility
2025-08-08 02:44:03,835 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:03,874 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:03,874 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 02:44:03,874 - openevolve.database - INFO - Initialized program database with 0 programs
2025-08-08 02:44:03,895 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:03,895 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:03,895 - openevolve.controller - INFO - Initialized OpenEvolve with /tmp/79aaf1b6a2d69eb390c5418ff3ed0097.py
2025-08-08 02:44:03,896 - openevolve.controller - INFO - Adding initial program to database
2025-08-08 02:44:03,896 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(2964 chars)
2025-08-08 02:44:10,805 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 02:44:10,805 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.043,"custom_timing":5.04},"runtime":5.04,"runtime_stats":{"mean":5.04,"std":0.0166,"min":5.02,"max":5.13,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:2"}}}
2025-08-08 02:44:10,806 - openevolve.evaluator - INFO - Evaluated program 5db0f343-99bb-4a6b-8e57-bf192e97550d in 6.91s: compiled=1.0000, correctness=1.0000, stage=reference code, passed=0.0000, score=0.0000, speed_up=1.0000, runtime_ms=5.0400, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.043, 'custom_timing': 5.04}
2025-08-08 02:44:10,806 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 0, 'complexity': 2}
2025-08-08 02:44:10,820 - openevolve.threaded_parallel - INFO - Initializing threaded evaluation pool with 3 workers
2025-08-08 02:44:10,821 - openevolve.threaded_parallel - INFO - Started thread pool with 3 threads
2025-08-08 02:44:10,821 - openevolve.threaded_parallel - INFO - Started improved parallel controller
2025-08-08 02:44:10,822 - openevolve.controller - INFO - Using island-based evolution with 3 islands
2025-08-08 02:44:10,822 - openevolve.database - INFO - Island Status:
2025-08-08 02:44:10,822 - openevolve.database - INFO -  * Island 0: 1 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0 (best: 5db0f343-99bb-4a6b-8e57-bf192e97550d)
2025-08-08 02:44:10,822 - openevolve.database - INFO -    Island 1: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 02:44:10,822 - openevolve.database - INFO -    Island 2: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 02:44:10,822 - openevolve.threaded_parallel - INFO - Starting improved parallel evolution from iteration 0 for 30 iterations (total: 30)
2025-08-08 02:44:10,962 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:10,962 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:10,963 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:11,096 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:11,096 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 02:44:11,099 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,099 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,100 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:11,100 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 02:44:11,101 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 02:44:11,101 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 02:44:11,101 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 02:44:11,102 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,102 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,103 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,104 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level3_50_ReLUSelfAttention/evaluation.py
2025-08-08 02:44:11,105 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 02:44:11,106 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 02:58:47,387 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 02:58:47,390 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(3877 chars)
2025-08-08 02:58:50,826 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 02:58:50,826 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  Fil
2025-08-08 02:58:50,826 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 02:58:50,827 - openevolve.evaluator - INFO - Evaluated program 932891d4-2a29-44e8-8dbc-8bb390448b8c in 3.44s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp0sh74d7y.py", line 83, in forward\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 30:12:\n    k_ptrs = k_ptr + pid_b * stride_kb + pid_h * stride_kh + (offs_n[None, :] * stride_kt + offs_d[:, None] * stride_kd)\n    v_ptrs = v_ptr + pid_b * stride_vb + pid_h * stride_vh + (offs_n[:, None] * stride_vt + offs_d[None, :] * stride_vd)\n\n    acc = tl.zeros((BLOCK_M, BLOCK_D), dtype=tl.float32)\n    for block_n in range(0, seq_len, BLOCK_N):\n        offs_n_curr = block_n + offs_n\n\n        mask_n = offs_n_curr < seq_len\n        mask_mn = (offs_m[:, None] >= offs_n_curr[None, :]) & (offs_m[:, None] < seq_len)\n\n        q = tl.load(q_ptrs, mask=offs_m[:, None] < seq_len, other=0.0)\n        k = tl.load(k_ptrs + block_n * stride_kt, mask=mask_n, other=0.0)\n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 02:58:50,829 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 9}
2025-08-08 02:58:50,829 - openevolve.database - INFO - New best program 932891d4-2a29-44e8-8dbc-8bb390448b8c replaces 5db0f343-99bb-4a6b-8e57-bf192e97550d
2025-08-08 02:58:50,830 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 02:58:50,843 - openevolve.threaded_parallel - INFO - Iteration 0: Program 932891d4-2a29-44e8-8dbc-8bb390448b8c (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 879.72s
2025-08-08 02:58:50,843 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp0sh74d7y.py", line 83, in forward\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 30:12:\n    k_ptrs = k_ptr + pid_b * stride_kb + pid_h * stride_kh + (offs_n[None, :] * stride_kt + offs_d[:, None] * stride_kd)\n    v_ptrs = v_ptr + pid_b * stride_vb + pid_h * stride_vh + (offs_n[:, None] * stride_vt + offs_d[None, :] * stride_vd)\n\n    acc = tl.zeros((BLOCK_M, BLOCK_D), dtype=tl.float32)\n    for block_n in range(0, seq_len, BLOCK_N):\n        offs_n_curr = block_n + offs_n\n\n        mask_n = offs_n_curr < seq_len\n        mask_mn = (offs_m[:, None] >= offs_n_curr[None, :]) & (offs_m[:, None] < seq_len)\n\n        q = tl.load(q_ptrs, mask=offs_m[:, None] < seq_len, other=0.0)\n        k = tl.load(k_ptrs + block_n * stride_kt, mask=mask_n, other=0.0)\n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 02:58:50,843 - openevolve.threaded_parallel - INFO - ðŸŒŸ New best solution found at iteration 0: 932891d4-2a29-44e8-8dbc-8bb390448b8c
2025-08-08 02:58:50,843 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 0
2025-08-08 02:58:50,844 - openevolve.database - INFO - Island Status:
2025-08-08 02:58:50,844 - openevolve.database - INFO -  * Island 0: 2 programs, best=10.0000, avg=5.0000, diversity=445.60, gen=1 (best: 932891d4-2a29-44e8-8dbc-8bb390448b8c)
2025-08-08 02:58:50,844 - openevolve.database - INFO -    Island 1: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 02:58:50,844 - openevolve.database - INFO -    Island 2: 0 programs, best=0.0000, avg=0.0000, diversity=0.00, gen=0
2025-08-08 02:58:50,875 - openevolve.database - INFO - Saved database with 2 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_0
2025-08-08 02:58:50,894 - openevolve.controller - INFO - Saved best program at checkpoint 0 with metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp0sh74d7y.py", line 83, in forward\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 30:12:\n    k_ptrs = k_ptr + pid_b * stride_kb + pid_h * stride_kh + (offs_n[None, :] * stride_kt + offs_d[:, None] * stride_kd)\n    v_ptrs = v_ptr + pid_b * stride_vb + pid_h * stride_vh + (offs_n[:, None] * stride_vt + offs_d[None, :] * stride_vd)\n\n    acc = tl.zeros((BLOCK_M, BLOCK_D), dtype=tl.float32)\n    for block_n in range(0, seq_len, BLOCK_N):\n        offs_n_curr = block_n + offs_n\n\n        mask_n = offs_n_curr < seq_len\n        mask_mn = (offs_m[:, None] >= offs_n_curr[None, :]) & (offs_m[:, None] < seq_len)\n\n        q = tl.load(q_ptrs, mask=offs_m[:, None] < seq_len, other=0.0)\n        k = tl.load(k_ptrs + block_n * stride_kt, mask=mask_n, other=0.0)\n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1037, in _load_legacy\n    mask = self.broadcast_impl_shape(mask, ptr.type.get_block_shapes())\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 697, in broadcast_impl_shape\n    raise ValueError(f"Cannot broadcast, rank mismatch: {src_shape}, {shape}")\nValueError: Cannot broadcast, rank mismatch: [\'64\'], [\'64\', \'64\']\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 02:58:50,894 - openevolve.controller - INFO - Saved checkpoint at iteration 0 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_0
2025-08-08 03:03:39,683 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:03:39,685 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4099 chars)
2025-08-08 03:03:40,139 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:03:40,139 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(5000 chars)
2025-08-08 03:03:43,095 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:03:43,095 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  Fil
2025-08-08 03:03:43,095 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:03:43,096 - openevolve.evaluator - INFO - Evaluated program 4f39fad2-e977-4274-8a30-a75b22a9c812 in 3.41s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpq1m_695x.py", line 89, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 31:12:\n    v_base = pid_b * stride_vb + pid_h * stride_vh\n\n    acc = tl.zeros((BLOCK_T, BLOCK_D), dtype=tl.float32)\n    for j_block in range(0, tl.cdiv(T, BLOCK_T)):\n        j_start = j_block * BLOCK_T\n        offs_j = j_start + tl.arange(0, BLOCK_T)\n\n        mask_i = offs_i < T\n        mask_j = offs_j < T\n        mask_causal = offs_j[None, :] <= offs_i[:, None]\n\n        q = tl.load(q_base + offs_i[:, None] * stride_qt + offs_d[None, :] * stride_qd, \n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:03:43,099 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:03:43,119 - openevolve.threaded_parallel - INFO - Iteration 1: Program 4f39fad2-e977-4274-8a30-a75b22a9c812 (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 1172.00s
2025-08-08 03:03:43,119 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpq1m_695x.py", line 89, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 31:12:\n    v_base = pid_b * stride_vb + pid_h * stride_vh\n\n    acc = tl.zeros((BLOCK_T, BLOCK_D), dtype=tl.float32)\n    for j_block in range(0, tl.cdiv(T, BLOCK_T)):\n        j_start = j_block * BLOCK_T\n        offs_j = j_start + tl.arange(0, BLOCK_T)\n\n        mask_i = offs_i < T\n        mask_j = offs_j < T\n        mask_causal = offs_j[None, :] <= offs_i[:, None]\n\n        q = tl.load(q_base + offs_i[:, None] * stride_qt + offs_d[None, :] * stride_qd, \n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:03:43,455 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:03:43,455 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmp2v8mnqoe.py\", line 120, in forward\n    _masked_relu_attention[gri
2025-08-08 03:03:43,455 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:03:43,455 - openevolve.evaluator - INFO - Evaluated program 0f149d77-439c-4dd8-ad94-14c4a8d4d53b in 3.32s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2v8mnqoe.py", line 120, in forward\n    _masked_relu_attention[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 27:8:\n    offs_b_q = pid_b * stride_b_q\n    offs_h_q = pid_h * stride_h_q\n    offs_i_q = pid_i * stride_t_q\n    q_base = q_ptr + offs_b_q + offs_h_q + offs_i_q\n\n    # Load query vector in chunks\n    d_offsets = tl.arange(0, BLOCK_D)\n    q_chunks = []\n    for d in range(0, HS, BLOCK_D):\n        mask = d + d_offsets < HS\n        q_chunk = tl.load(q_base + d + d_offsets, mask=mask, other=0.0)\n        q_chunks.append(q_chunk)\n        ^\nValueError("\'append\' is not in list")\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1295, in __getattr__\n    return self.values[self.type.fields.index(name)]\nValueError: \'append\' is not in list\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:03:43,459 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:03:43,473 - openevolve.threaded_parallel - INFO - Iteration 2: Program 0f149d77-439c-4dd8-ad94-14c4a8d4d53b (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 1172.35s
2025-08-08 03:03:43,474 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2v8mnqoe.py", line 120, in forward\n    _masked_relu_attention[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 27:8:\n    offs_b_q = pid_b * stride_b_q\n    offs_h_q = pid_h * stride_h_q\n    offs_i_q = pid_i * stride_t_q\n    q_base = q_ptr + offs_b_q + offs_h_q + offs_i_q\n\n    # Load query vector in chunks\n    d_offsets = tl.arange(0, BLOCK_D)\n    q_chunks = []\n    for d in range(0, HS, BLOCK_D):\n        mask = d + d_offsets < HS\n        q_chunk = tl.load(q_base + d + d_offsets, mask=mask, other=0.0)\n        q_chunks.append(q_chunk)\n        ^\nValueError("\'append\' is not in list")\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 1295, in __getattr__\n    return self.values[self.type.fields.index(name)]\nValueError: \'append\' is not in list\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:13:02,008 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:13:02,011 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4282 chars)
2025-08-08 03:13:05,181 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:13:05,181 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","runtime_error":"Traceback (most recent call last):\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py\", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py\", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  Fil
2025-08-08 03:13:05,181 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:13:05,182 - openevolve.evaluator - INFO - Evaluated program dad56714-f268-45ee-98b4-174533401368 in 3.17s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpbvrb3kxy.py", line 103, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 30:12:\n    k_base = pid_b * stride_kb + pid_h * stride_kh\n    v_base = pid_b * stride_vb + pid_h * stride_vh\n\n    acc = tl.zeros((BLOCK_M, BLOCK_D), dtype=tl.float32)\n    for block_n in range(0, tl.cdiv(T, BLOCK_N)):\n        offs_n_curr = block_n * BLOCK_N\n\n        mask_m = offs_m < T\n        mask_n = (offs_n_curr + offs_n) < T\n        mask_causal = (offs_n_curr + offs_n)[None, :] <= offs_m[:, None]\n\n        q = tl.load(\n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:13:05,186 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 6}
2025-08-08 03:13:05,186 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:13:05,199 - openevolve.threaded_parallel - INFO - Iteration 5: Program dad56714-f268-45ee-98b4-174533401368 (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 561.72s
2025-08-08 03:13:05,200 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpbvrb3kxy.py", line 103, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 30:12:\n    k_base = pid_b * stride_kb + pid_h * stride_kh\n    v_base = pid_b * stride_vb + pid_h * stride_vh\n\n    acc = tl.zeros((BLOCK_M, BLOCK_D), dtype=tl.float32)\n    for block_n in range(0, tl.cdiv(T, BLOCK_N)):\n        offs_n_curr = block_n * BLOCK_N\n\n        mask_m = offs_m < T\n        mask_n = (offs_n_curr + offs_n) < T\n        mask_causal = (offs_n_curr + offs_n)[None, :] <= offs_m[:, None]\n\n        q = tl.load(\n            ^\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 42, in wrapper\n    return fn(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/core.py", line 2150, in load\n    return _semantic.load(pointer, mask, other, boundary_check, padding_option, cache_modifier, eviction_policy,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1086, in load\n    return self._load_legacy(ptr, mask, other, boundary_check, padding, cache, eviction, is_volatile)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/language/semantic.py", line 1017, in _load_legacy\n    raise ValueError(f"Unsupported ptr type {ptr.type.__repr__()} in `tl.load`")\nValueError: Unsupported ptr type <[\'64\', \'64\'], int32> in `tl.load`\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:13:45,244 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:13:45,245 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4018 chars)
2025-08-08 03:13:49,383 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:13:49,383 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:7","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.119,"custom_timing":1.82},"runtime":1.82,"runtime_stats":{"mean":1.82,"std":0.0119,"min":1.81,"max":1.85,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:7"}}}
2025-08-08 03:13:49,384 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.119  score=20.00
2025-08-08 03:13:49,384 - openevolve.evaluator - INFO - Evaluated program 5ab066a2-9f14-4509-bd55-98436c5190b8 in 4.14s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:13:49,387 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:13:49,394 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 5}
2025-08-08 03:13:49,395 - openevolve.database - INFO - New best program 5ab066a2-9f14-4509-bd55-98436c5190b8 replaces 932891d4-2a29-44e8-8dbc-8bb390448b8c
2025-08-08 03:13:49,407 - openevolve.threaded_parallel - INFO - Iteration 4: Program 5ab066a2-9f14-4509-bd55-98436c5190b8 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 606.28s
2025-08-08 03:13:49,407 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:13:49,407 - openevolve.threaded_parallel - INFO - ðŸŒŸ New best solution found at iteration 4: 5ab066a2-9f14-4509-bd55-98436c5190b8
2025-08-08 03:18:57,459 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:18:57,461 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4989 chars)
2025-08-08 03:19:46,938 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:19:46,939 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.001,"custom_timing":403.0},"runtime":403.0,"runtime_stats":{"mean":403.0,"std":1.07,"min":401.0,"max":405.0,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:4"}}}
2025-08-08 03:19:46,940 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.001  score=20.00
2025-08-08 03:19:46,940 - openevolve.evaluator - INFO - Evaluated program 5261f736-65d3-49df-8eae-2f06372b524c in 49.48s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0010, runtime_ms=403.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.001, 'custom_timing': 403.0}
2025-08-08 03:19:46,945 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:19:46,947 - openevolve.database - INFO - MAP-Elites cell improved: {'score': 9, 'complexity': 9} (fitness: 10.000 -> 20.000)
2025-08-08 03:19:46,959 - openevolve.threaded_parallel - INFO - Iteration 3: Program 5261f736-65d3-49df-8eae-2f06372b524c (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 1256.11s
2025-08-08 03:19:46,959 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0010, runtime_ms=403.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.001, 'custom_timing': 403.0}
2025-08-08 03:19:46,959 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 3
2025-08-08 03:19:46,960 - openevolve.database - INFO - Island Status:
2025-08-08 03:19:46,960 - openevolve.database - INFO -    Island 0: 4 programs, best=20.0000, avg=10.0000, diversity=264.83, gen=2 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 03:19:46,960 - openevolve.database - INFO -    Island 1: 2 programs, best=20.0000, avg=15.0000, diversity=151.10, gen=2 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 03:19:46,960 - openevolve.database - INFO -  * Island 2: 1 programs, best=10.0000, avg=10.0000, diversity=0.00, gen=2 (best: dad56714-f268-45ee-98b4-174533401368)
2025-08-08 03:19:47,043 - openevolve.database - INFO - Saved database with 7 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_3
2025-08-08 03:19:47,060 - openevolve.controller - INFO - Saved best program at checkpoint 3 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:19:47,060 - openevolve.controller - INFO - Saved checkpoint at iteration 3 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_3
2025-08-08 03:23:35,481 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:23:35,483 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4182 chars)
2025-08-08 03:23:39,502 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:23:39,502 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.119,"custom_timing":1.82},"runtime":1.82,"runtime_stats":{"mean":1.82,"std":0.0167,"min":1.8,"max":1.85,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:1"}}}
2025-08-08 03:23:39,502 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.119  score=20.00
2025-08-08 03:23:39,502 - openevolve.evaluator - INFO - Evaluated program 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74 in 4.02s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:23:39,505 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:23:39,521 - openevolve.threaded_parallel - INFO - Iteration 6: Program 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 634.32s
2025-08-08 03:23:39,521 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:23:39,521 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 6
2025-08-08 03:23:39,522 - openevolve.database - INFO - Island Status:
2025-08-08 03:23:39,522 - openevolve.database - INFO -  * Island 0: 4 programs, best=20.0000, avg=10.0000, diversity=264.83, gen=3 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 03:23:39,522 - openevolve.database - INFO -    Island 1: 2 programs, best=20.0000, avg=15.0000, diversity=151.10, gen=2 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 03:23:39,522 - openevolve.database - INFO -    Island 2: 2 programs, best=20.0000, avg=15.0000, diversity=172.00, gen=2 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 03:23:39,616 - openevolve.database - INFO - Saved database with 8 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_6
2025-08-08 03:23:39,632 - openevolve.controller - INFO - Saved best program at checkpoint 6 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:23:39,632 - openevolve.controller - INFO - Saved checkpoint at iteration 6 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_6
2025-08-08 03:25:42,091 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:25:42,093 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(3820 chars)
2025-08-08 03:25:45,329 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:25:45,329 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmpjckk9nz8.py\", line 83, in forward\n    relu_attention_kernel[grid]
2025-08-08 03:25:45,329 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:25:45,330 - openevolve.evaluator - INFO - Evaluated program d83c1ce9-e6a2-4f49-906d-7c05609fb565 in 3.24s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpjckk9nz8.py", line 83, in forward\n    relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 46:31:\n\n        att = tl.dot(q, tl.trans(k)) * scale\n        att = tl.where(mask_causal, att, float(\'-inf\'))\n        att = tl.maximum(att, 0.0)\n\n        v = tl.load(v_base + offs_n_curr[:, None] * stride_vt + offs_d[None, :] * stride_vd, \n                   mask=mask_n[:, None], other=0.0)\n\n        acc += tl.dot(att, v)\n\n    o_base = output_ptr + pid_b * stride_ob + pid_h * stride_oh + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od\n    tl.store(o_base, acc, mask=mask_m[:, None])\n                               ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:25:45,334 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:25:45,337 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 4}
2025-08-08 03:25:45,355 - openevolve.threaded_parallel - INFO - Iteration 7: Program d83c1ce9-e6a2-4f49-906d-7c05609fb565 (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 715.94s
2025-08-08 03:25:45,355 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpjckk9nz8.py", line 83, in forward\n    relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 46:31:\n\n        att = tl.dot(q, tl.trans(k)) * scale\n        att = tl.where(mask_causal, att, float(\'-inf\'))\n        att = tl.maximum(att, 0.0)\n\n        v = tl.load(v_base + offs_n_curr[:, None] * stride_vt + offs_d[None, :] * stride_vd, \n                   mask=mask_n[:, None], other=0.0)\n\n        acc += tl.dot(att, v)\n\n    o_base = output_ptr + pid_b * stride_ob + pid_h * stride_oh + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od\n    tl.store(o_base, acc, mask=mask_m[:, None])\n                               ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:29:39,304 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:29:39,306 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4490 chars)
2025-08-08 03:29:42,385 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:29:42,385 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmpzbjqak6n.py\", line 108, in forward\n    _relu_attention_kernel[gri
2025-08-08 03:29:42,385 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:29:42,386 - openevolve.evaluator - INFO - Evaluated program 884ed3b1-ad75-4da3-83bb-79d41f973127 in 3.08s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpzbjqak6n.py", line 108, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 64:13:\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    # Compute output base pointer and store results\n    o_ptr_base = o_ptr + pid_b * stride_ob + pid_h * stride_oh\n    tl.store(\n        o_ptr_base + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od,\n        acc,\n        mask=mask_m[:, None]\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:29:42,389 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:29:42,393 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 7}
2025-08-08 03:29:42,404 - openevolve.threaded_parallel - INFO - Iteration 9: Program 884ed3b1-ad75-4da3-83bb-79d41f973127 (parent: dad56714-f268-45ee-98b4-174533401368) completed in 362.88s
2025-08-08 03:29:42,404 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpzbjqak6n.py", line 108, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 64:13:\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    # Compute output base pointer and store results\n    o_ptr_base = o_ptr + pid_b * stride_ob + pid_h * stride_oh\n    tl.store(\n        o_ptr_base + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od,\n        acc,\n        mask=mask_m[:, None]\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:29:42,404 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 9
2025-08-08 03:29:42,405 - openevolve.database - INFO - Island Status:
2025-08-08 03:29:42,405 - openevolve.database - INFO -    Island 0: 5 programs, best=20.0000, avg=10.0000, diversity=204.05, gen=3 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 03:29:42,405 - openevolve.database - INFO -    Island 1: 3 programs, best=20.0000, avg=13.3333, diversity=136.00, gen=3 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 03:29:42,406 - openevolve.database - INFO -  * Island 2: 2 programs, best=20.0000, avg=15.0000, diversity=172.00, gen=3 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 03:29:42,523 - openevolve.database - INFO - Saved database with 10 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_9
2025-08-08 03:29:42,538 - openevolve.controller - INFO - Saved best program at checkpoint 9 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:29:42,539 - openevolve.controller - INFO - Saved checkpoint at iteration 9 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_9
2025-08-08 03:32:28,054 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:32:28,056 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4311 chars)
2025-08-08 03:32:35,669 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:32:35,669 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.006,"custom_timing":37.0},"runtime":37.0,"runtime_stats":{"mean":37.0,"std":0.285,"min":36.4,"max":38.2,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:0"}}}
2025-08-08 03:32:35,670 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.006  score=20.00
2025-08-08 03:32:35,670 - openevolve.evaluator - INFO - Evaluated program f04d702f-f89d-4384-8c5a-41729a549e82 in 7.62s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0060, runtime_ms=37.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.006, 'custom_timing': 37.0}
2025-08-08 03:32:35,674 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:32:35,676 - openevolve.database - INFO - MAP-Elites cell improved: {'score': 9, 'complexity': 6} (fitness: 10.000 -> 20.000)
2025-08-08 03:32:35,718 - openevolve.threaded_parallel - INFO - Iteration 8: Program f04d702f-f89d-4384-8c5a-41729a549e82 (parent: 0f149d77-439c-4dd8-ad94-14c4a8d4d53b) completed in 768.73s
2025-08-08 03:32:35,718 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0060, runtime_ms=37.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.006, 'custom_timing': 37.0}
2025-08-08 03:37:21,508 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:37:21,510 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4379 chars)
2025-08-08 03:37:29,984 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:37:29,985 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","max_difference":["0.027262"],"avg_difference":["0.002326"],"correctness_issue":"Output mismatch","correctness_trials":"(4 / 5)","reference_timing_ms":0.217,"speed_up":-1.0,"custom_timing":-1.0},"runtime":-1.0,"runtime_stats":{}}}
2025-08-08 03:37:29,985 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:37:29,985 - openevolve.evaluator - INFO - Evaluated program b776f69d-f5fd-453f-8807-137c94a74c2b in 8.48s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'max_difference': ['0.027262'], 'avg_difference': ['0.002326'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(4 / 5)', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:37:29,989 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:37:30,002 - openevolve.threaded_parallel - INFO - Iteration 10: Program b776f69d-f5fd-453f-8807-137c94a74c2b (parent: 5db0f343-99bb-4a6b-8e57-bf192e97550d) completed in 704.65s
2025-08-08 03:37:30,002 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'max_difference': ['0.027262'], 'avg_difference': ['0.002326'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(4 / 5)', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:41:18,638 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:41:18,640 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4417 chars)
2025-08-08 03:41:21,264 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:41:21,264 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmps90gco_u.py\", line 107, in forward\n    BLOCK_D_val = triton.next_
2025-08-08 03:41:21,264 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:41:21,264 - openevolve.evaluator - INFO - Evaluated program 4c7c6201-6068-402f-9523-8c1bfda0e5e6 in 2.63s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmps90gco_u.py", line 107, in forward\n    BLOCK_D_val = triton.next_power_of_two(HS)\nAttributeError: module \'triton\' has no attribute \'next_power_of_two\'. Did you mean: \'next_power_of_2\'?\n', 'runtime_error_name': 'builtins.AttributeError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:41:21,269 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:41:21,281 - openevolve.threaded_parallel - INFO - Iteration 11: Program 4c7c6201-6068-402f-9523-8c1bfda0e5e6 (parent: 0f149d77-439c-4dd8-ad94-14c4a8d4d53b) completed in 698.88s
2025-08-08 03:41:21,281 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmps90gco_u.py", line 107, in forward\n    BLOCK_D_val = triton.next_power_of_two(HS)\nAttributeError: module \'triton\' has no attribute \'next_power_of_two\'. Did you mean: \'next_power_of_2\'?\n', 'runtime_error_name': 'builtins.AttributeError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:42:47,507 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:42:47,509 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4089 chars)
2025-08-08 03:42:51,617 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:42:51,618 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.119,"custom_timing":1.82},"runtime":1.82,"runtime_stats":{"mean":1.82,"std":0.0115,"min":1.81,"max":1.86,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:3"}}}
2025-08-08 03:42:51,618 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.119  score=20.00
2025-08-08 03:42:51,618 - openevolve.evaluator - INFO - Evaluated program 4a0c9b43-e28d-4ad6-9fac-cd83366373f2 in 4.11s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:42:51,621 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:42:51,635 - openevolve.threaded_parallel - INFO - Iteration 13: Program 4a0c9b43-e28d-4ad6-9fac-cd83366373f2 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 321.63s
2025-08-08 03:42:51,635 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:45:59,212 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 03:45:59,214 - openevolve.evaluator - INFO - Evaluated program b41da0a8-1422-4785-8247-7103bd2042b2 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 03:45:59,218 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:45:59,219 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': -1000, 'complexity': 0}
2025-08-08 03:45:59,225 - openevolve.threaded_parallel - INFO - Iteration 12: Program b41da0a8-1422-4785-8247-7103bd2042b2 (parent: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74) completed in 803.54s
2025-08-08 03:45:59,225 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 03:45:59,225 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 12
2025-08-08 03:45:59,227 - openevolve.database - INFO - Island Status:
2025-08-08 03:45:59,227 - openevolve.database - INFO -    Island 0: 7 programs, best=20.0000, avg=-5.7143, diversity=444.95, gen=5 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 03:45:59,227 - openevolve.database - INFO -  * Island 1: 4 programs, best=20.0000, avg=12.5000, diversity=113.97, gen=5 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 03:45:59,227 - openevolve.database - INFO -    Island 2: 4 programs, best=20.0000, avg=17.5000, diversity=137.02, gen=4 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 03:45:59,403 - openevolve.database - INFO - Saved database with 15 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_12
2025-08-08 03:45:59,419 - openevolve.controller - INFO - Saved best program at checkpoint 12 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:45:59,419 - openevolve.controller - INFO - Saved checkpoint at iteration 12 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_12
2025-08-08 03:47:40,020 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:47:40,021 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4357 chars)
2025-08-08 03:47:44,157 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:47:44,157 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.108,"custom_timing":2.01},"runtime":2.01,"runtime_stats":{"mean":2.01,"std":0.027,"min":1.99,"max":2.22,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:1"}}}
2025-08-08 03:47:44,157 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.108  score=20.00
2025-08-08 03:47:44,157 - openevolve.evaluator - INFO - Evaluated program 05621f53-6f8e-4adc-91dc-e50df94dc13a in 4.14s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1080, runtime_ms=2.0100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.108, 'custom_timing': 2.01}
2025-08-08 03:47:44,160 - openevolve.database - INFO - New MAP-Elites cell occupied: {'score': 9, 'complexity': 8}
2025-08-08 03:47:44,161 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:47:44,172 - openevolve.threaded_parallel - INFO - Iteration 14: Program 05621f53-6f8e-4adc-91dc-e50df94dc13a (parent: 884ed3b1-ad75-4da3-83bb-79d41f973127) completed in 382.89s
2025-08-08 03:47:44,172 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1080, runtime_ms=2.0100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.108, 'custom_timing': 2.01}
2025-08-08 03:48:31,788 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:48:31,790 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4371 chars)
2025-08-08 03:48:34,842 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:48:34,842 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:2","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmph3rzwiek.py\", line 104, in forward\n    _relu_attention_kernel[gri
2025-08-08 03:48:34,842 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 03:48:34,843 - openevolve.evaluator - INFO - Evaluated program 804b23eb-2b00-4617-aed0-59b86e891bf3 in 3.06s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmph3rzwiek.py", line 104, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 60:13:\n            v_base + (offs_n_curr + offs_n)[:, None] * stride_vt + offs_d[None, :] * stride_vd,\n            mask=mask_n[:, None] & (offs_d[None, :] < BLOCK_D),\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    tl.store(\n        o_base + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od,\n        acc,\n        mask=mask_m[:, None] & (offs_d[None, :] < BLOCK_D)\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:48:34,847 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:48:34,917 - openevolve.threaded_parallel - INFO - Iteration 15: Program 804b23eb-2b00-4617-aed0-59b86e891bf3 (parent: dad56714-f268-45ee-98b4-174533401368) completed in 343.22s
2025-08-08 03:48:34,917 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:2', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmph3rzwiek.py", line 104, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 60:13:\n            v_base + (offs_n_curr + offs_n)[:, None] * stride_vt + offs_d[None, :] * stride_vd,\n            mask=mask_n[:, None] & (offs_d[None, :] < BLOCK_D),\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    tl.store(\n        o_base + offs_m[:, None] * stride_ot + offs_d[None, :] * stride_od,\n        acc,\n        mask=mask_m[:, None] & (offs_d[None, :] < BLOCK_D)\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 03:48:34,918 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 15
2025-08-08 03:48:34,919 - openevolve.database - INFO - Island Status:
2025-08-08 03:48:34,919 - openevolve.database - INFO -  * Island 0: 7 programs, best=20.0000, avg=-5.7143, diversity=444.95, gen=6 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 03:48:34,919 - openevolve.database - INFO -    Island 1: 5 programs, best=20.0000, avg=14.0000, diversity=109.53, gen=5 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 03:48:34,919 - openevolve.database - INFO -    Island 2: 5 programs, best=20.0000, avg=16.0000, diversity=141.22, gen=5 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 03:48:35,239 - openevolve.database - INFO - Saved database with 17 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_15
2025-08-08 03:48:35,254 - openevolve.controller - INFO - Saved best program at checkpoint 15 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 03:48:35,254 - openevolve.controller - INFO - Saved checkpoint at iteration 15 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_15
2025-08-08 03:54:06,201 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 03:54:06,203 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4386 chars)
2025-08-08 03:54:10,685 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 03:54:10,685 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.115,"custom_timing":1.89},"runtime":1.89,"runtime_stats":{"mean":1.89,"std":0.00944,"min":1.88,"max":1.92,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:4"}}}
2025-08-08 03:54:10,685 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.115  score=20.00
2025-08-08 03:54:10,686 - openevolve.evaluator - INFO - Evaluated program e8b5166e-0eed-4ef1-ab5e-b0224eebb8e1 in 4.49s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8900, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.89}
2025-08-08 03:54:10,690 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:54:10,731 - openevolve.threaded_parallel - INFO - Iteration 17: Program e8b5166e-0eed-4ef1-ab5e-b0224eebb8e1 (parent: 884ed3b1-ad75-4da3-83bb-79d41f973127) completed in 386.53s
2025-08-08 03:54:10,731 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8900, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.89}
2025-08-08 03:57:55,048 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 03:57:55,050 - openevolve.evaluator - INFO - Evaluated program 631a521e-2303-458e-8e89-428a2fc377f3 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 03:57:55,054 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 03:57:55,071 - openevolve.threaded_parallel - INFO - Iteration 16: Program 631a521e-2303-458e-8e89-428a2fc377f3 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 715.83s
2025-08-08 03:57:55,072 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:02:43,696 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:02:43,698 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(3969 chars)
2025-08-08 04:02:48,452 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:02:48,452 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.102,"custom_timing":2.12},"runtime":2.12,"runtime_stats":{"mean":2.12,"std":0.0193,"min":2.1,"max":2.16,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:1"}}}
2025-08-08 04:02:48,452 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.102  score=20.00
2025-08-08 04:02:48,453 - openevolve.evaluator - INFO - Evaluated program a2f47fb2-6ca0-4451-9be8-74fe918a7230 in 4.76s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1020, runtime_ms=2.1200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.102, 'custom_timing': 2.12}
2025-08-08 04:02:48,454 - openevolve.database - INFO - MAP-Elites cell improved: {'score': 9, 'complexity': 7} (fitness: 10.000 -> 20.000)
2025-08-08 04:02:48,456 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:02:48,468 - openevolve.threaded_parallel - INFO - Iteration 18: Program a2f47fb2-6ca0-4451-9be8-74fe918a7230 (parent: 4a0c9b43-e28d-4ad6-9fac-cd83366373f2) completed in 853.61s
2025-08-08 04:02:48,468 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1020, runtime_ms=2.1200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.102, 'custom_timing': 2.12}
2025-08-08 04:02:48,468 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 18
2025-08-08 04:02:48,470 - openevolve.database - INFO - Island Status:
2025-08-08 04:02:48,470 - openevolve.database - INFO -  * Island 0: 8 programs, best=20.0000, avg=-2.5000, diversity=444.95, gen=7 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 04:02:48,470 - openevolve.database - INFO -    Island 1: 6 programs, best=20.0000, avg=-5.0000, diversity=395.98, gen=6 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 04:02:48,470 - openevolve.database - INFO -    Island 2: 6 programs, best=20.0000, avg=16.6667, diversity=150.98, gen=6 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 04:02:48,786 - openevolve.database - INFO - Saved database with 20 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_18
2025-08-08 04:02:48,801 - openevolve.controller - INFO - Saved best program at checkpoint 18 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 04:02:48,801 - openevolve.controller - INFO - Saved checkpoint at iteration 18 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_18
2025-08-08 04:05:57,486 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ invalid_answer 'import triton' is not found
2025-08-08 04:05:57,488 - openevolve.evaluator - INFO - Evaluated program 29333e5b-bc94-4606-8a1f-ab220cd20dd9 in 0.00s: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:05:57,493 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:05:57,506 - openevolve.threaded_parallel - INFO - Iteration 19: Program 29333e5b-bc94-4606-8a1f-ab220cd20dd9 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 706.80s
2025-08-08 04:05:57,507 - openevolve.threaded_parallel - INFO - Metrics: compiled=0.0000, correctness=0.0000, score=-100.0000, stage=no_valid_triton_code, feedback=You need to generate real and valid triton code for the core function. The key word 'import triton' is not found.
2025-08-08 04:07:19,803 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:07:19,805 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4744 chars)
2025-08-08 04:07:24,216 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:07:24,216 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:6","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.115,"custom_timing":1.88},"runtime":1.88,"runtime_stats":{"mean":1.88,"std":0.00489,"min":1.87,"max":1.9,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:6"}}}
2025-08-08 04:07:24,216 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.115  score=20.00
2025-08-08 04:07:24,217 - openevolve.evaluator - INFO - Evaluated program 0aa721d0-09db-465a-a398-1f2d556d1dc2 in 4.41s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8800, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.88}
2025-08-08 04:07:24,221 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:07:24,235 - openevolve.threaded_parallel - INFO - Iteration 20: Program 0aa721d0-09db-465a-a398-1f2d556d1dc2 (parent: 884ed3b1-ad75-4da3-83bb-79d41f973127) completed in 569.16s
2025-08-08 04:07:24,235 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8800, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.88}
2025-08-08 04:12:07,979 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:12:07,981 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4446 chars)
2025-08-08 04:12:11,016 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:12:11,016 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmp2cdz6k88.py\", line 108, in forward\n    _relu_attention_kernel[gri
2025-08-08 04:12:11,017 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 04:12:11,017 - openevolve.evaluator - INFO - Evaluated program 3ea3d456-07f7-46c8-8ccc-876f3b16115a in 3.04s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2cdz6k88.py", line 108, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 64:13:\n            mask=mask_n[:, None],\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    # Store output with proper pointer and mask\n    tl.store(\n        o_ptrs,\n        acc,\n        mask=mask_m[:, None]\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:12:11,021 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:12:11,040 - openevolve.threaded_parallel - INFO - Iteration 21: Program 3ea3d456-07f7-46c8-8ccc-876f3b16115a (parent: dad56714-f268-45ee-98b4-174533401368) completed in 562.56s
2025-08-08 04:12:11,040 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmp2cdz6k88.py", line 108, in forward\n    _relu_attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 594, in run\n    kernel = self.compile(src, target=target, options=options.__dict__)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 339, in compile\n    module = src.make_ir(options, codegen_fns, module_map, context)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/compiler/compiler.py", line 83, in make_ir\n    return ast_to_ttir(self.fn, self, context=context, options=options, codegen_fns=codegen_fns,\ntriton.compiler.errors.CompilationError: at 64:13:\n            mask=mask_n[:, None],\n            other=0.0\n        )\n\n        p = tl.dot(scores, v)\n        acc += p\n\n    # Store output with proper pointer and mask\n    tl.store(\n        o_ptrs,\n        acc,\n        mask=mask_m[:, None]\n             ^\nNameError(\'mask_m is not defined\')\n\n\nThe above exception was the direct cause of the following exception:\n\nNameError: mask_m is not defined\n', 'runtime_error_name': 'triton.compiler.errors.CompilationError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:12:11,040 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 21
2025-08-08 04:12:11,042 - openevolve.database - INFO - Island Status:
2025-08-08 04:12:11,042 - openevolve.database - INFO -  * Island 0: 9 programs, best=20.0000, avg=-13.3333, diversity=1006.68, gen=8 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 04:12:11,042 - openevolve.database - INFO -    Island 1: 7 programs, best=20.0000, avg=-1.4286, diversity=97.92, gen=7 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 04:12:11,042 - openevolve.database - INFO -    Island 2: 7 programs, best=20.0000, avg=15.7143, diversity=179.05, gen=7 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 04:12:11,341 - openevolve.database - INFO - Saved database with 23 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_21
2025-08-08 04:12:11,357 - openevolve.controller - INFO - Saved best program at checkpoint 21 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 04:12:11,357 - openevolve.controller - INFO - Saved checkpoint at iteration 21 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_21
2025-08-08 04:16:02,554 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:16:02,556 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4555 chars)
2025-08-08 04:16:06,665 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:16:06,665 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:5","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.108,"custom_timing":2.01},"runtime":2.01,"runtime_stats":{"mean":2.01,"std":0.00688,"min":2.0,"max":2.03,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:5"}}}
2025-08-08 04:16:06,665 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.108  score=20.00
2025-08-08 04:16:06,665 - openevolve.evaluator - INFO - Evaluated program d2225564-2550-4218-92cd-c531adbb98e2 in 4.11s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1080, runtime_ms=2.0100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.108, 'custom_timing': 2.01}
2025-08-08 04:16:06,669 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:16:06,688 - openevolve.threaded_parallel - INFO - Iteration 23: Program d2225564-2550-4218-92cd-c531adbb98e2 (parent: 884ed3b1-ad75-4da3-83bb-79d41f973127) completed in 522.44s
2025-08-08 04:16:06,688 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1080, runtime_ms=2.0100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.108, 'custom_timing': 2.01}
2025-08-08 04:17:41,070 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:17:41,072 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4020 chars)
2025-08-08 04:17:45,180 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:17:45,180 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:3","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.119,"custom_timing":1.83},"runtime":1.83,"runtime_stats":{"mean":1.83,"std":0.00704,"min":1.81,"max":1.87,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:3"}}}
2025-08-08 04:17:45,180 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.119  score=20.00
2025-08-08 04:17:45,181 - openevolve.evaluator - INFO - Evaluated program 5e9597ef-27ea-421b-bc35-d38cdb5804a2 in 4.11s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8300, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.83}
2025-08-08 04:17:45,185 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:17:45,196 - openevolve.threaded_parallel - INFO - Iteration 22: Program 5e9597ef-27ea-421b-bc35-d38cdb5804a2 (parent: 932891d4-2a29-44e8-8dbc-8bb390448b8c) completed in 707.69s
2025-08-08 04:17:45,196 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8300, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:3', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.83}
2025-08-08 04:17:46,416 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:17:46,416 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4741 chars)
2025-08-08 04:17:50,438 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:17:50,438 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:5","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.115,"custom_timing":1.88},"runtime":1.88,"runtime_stats":{"mean":1.88,"std":0.00651,"min":1.87,"max":1.9,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:5"}}}
2025-08-08 04:17:50,438 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.115  score=20.00
2025-08-08 04:17:50,438 - openevolve.evaluator - INFO - Evaluated program af5610e0-e5fd-455e-878e-97a7073c9b96 in 4.02s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8800, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.88}
2025-08-08 04:17:50,442 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:17:50,444 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:17:50,444 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:17:50,456 - openevolve.threaded_parallel - INFO - Iteration 24: Program af5610e0-e5fd-455e-878e-97a7073c9b96 (parent: dad56714-f268-45ee-98b4-174533401368) completed in 339.42s
2025-08-08 04:17:50,457 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1150, runtime_ms=1.8800, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:5', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.115, 'custom_timing': 1.88}
2025-08-08 04:17:50,457 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 24
2025-08-08 04:17:50,458 - openevolve.database - INFO - Island Status:
2025-08-08 04:17:50,458 - openevolve.database - INFO -  * Island 0: 9 programs, best=20.0000, avg=0.0000, diversity=1006.68, gen=9 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 04:17:50,458 - openevolve.database - INFO -    Island 1: 8 programs, best=20.0000, avg=1.2500, diversity=97.92, gen=8 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 04:17:50,459 - openevolve.database - INFO -    Island 2: 8 programs, best=20.0000, avg=16.2500, diversity=179.05, gen=8 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 04:17:50,728 - openevolve.database - INFO - Saved database with 25 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_24
2025-08-08 04:17:50,744 - openevolve.controller - INFO - Saved best program at checkpoint 24 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 04:17:50,744 - openevolve.controller - INFO - Saved checkpoint at iteration 24 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_24
2025-08-08 04:21:49,002 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:21:49,004 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4475 chars)
2025-08-08 04:21:56,994 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:21:56,995 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:1","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.006,"custom_timing":37.0},"runtime":37.0,"runtime_stats":{"mean":37.0,"std":0.262,"min":36.4,"max":37.4,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:1"}}}
2025-08-08 04:21:56,995 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.006  score=20.00
2025-08-08 04:21:56,995 - openevolve.evaluator - INFO - Evaluated program f3eaa2e5-a783-42fc-a58c-3f1786b81571 in 7.99s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0060, runtime_ms=37.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.006, 'custom_timing': 37.0}
2025-08-08 04:21:57,000 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:21:57,003 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:21:57,003 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:21:57,016 - openevolve.threaded_parallel - INFO - Iteration 26: Program f3eaa2e5-a783-42fc-a58c-3f1786b81571 (parent: 4c7c6201-6068-402f-9523-8c1bfda0e5e6) completed in 251.81s
2025-08-08 04:21:57,016 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.0060, runtime_ms=37.0000, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:1', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.006, 'custom_timing': 37.0}
2025-08-08 04:26:44,316 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:26:44,318 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4738 chars)
2025-08-08 04:26:48,212 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:26:48,212 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:6","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.127,"custom_timing":1.71},"runtime":1.71,"runtime_stats":{"mean":1.71,"std":0.0129,"min":1.69,"max":1.73,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:6"}}}
2025-08-08 04:26:48,212 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.127  score=20.00
2025-08-08 04:26:48,212 - openevolve.evaluator - INFO - Evaluated program 6e1ac1c0-5121-4216-8fd1-87600042eb60 in 3.90s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1270, runtime_ms=1.7100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.127, 'custom_timing': 1.71}
2025-08-08 04:26:48,217 - openevolve.llm.ensemble - INFO - Sampled model: deepseek
2025-08-08 04:26:48,222 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:26:48,222 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:26:48,235 - openevolve.threaded_parallel - INFO - Iteration 25: Program 6e1ac1c0-5121-4216-8fd1-87600042eb60 (parent: e8b5166e-0eed-4ef1-ab5e-b0224eebb8e1) completed in 641.54s
2025-08-08 04:26:48,235 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1270, runtime_ms=1.7100, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:6', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.127, 'custom_timing': 1.71}
2025-08-08 04:27:45,072 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:27:45,074 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(3847 chars)
2025-08-08 04:27:48,838 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:27:48,838 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:7","max_difference":["38.726704","36.558174","37.110256","39.102581","39.468750"],"avg_difference":["3.426451","3.417666","3.401273","3.408850","3.422051"],"correctness_issue":"Output mismatch","correctness_trials":"(0 / 5)","reference_timing_ms":0.217,"speed_up":-1.0,"custom_timing":-1.0},"runtime":-1.0,"runtime_stats":{}}}
2025-08-08 04:27:48,838 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 04:27:48,839 - openevolve.evaluator - INFO - Evaluated program c0ed169f-4e7b-471e-a7a6-56dfc6da2fd3 in 3.77s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'max_difference': ['38.726704', '36.558174', '37.110256', '39.102581', '39.468750'], 'avg_difference': ['3.426451', '3.417666', '3.401273', '3.408850', '3.422051'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:27:48,841 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:27:48,841 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:27:48,867 - openevolve.threaded_parallel - INFO - Iteration 28: Program c0ed169f-4e7b-471e-a7a6-56dfc6da2fd3 (parent: d83c1ce9-e6a2-4f49-906d-7c05609fb565) completed in 351.84s
2025-08-08 04:27:48,867 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'max_difference': ['38.726704', '36.558174', '37.110256', '39.102581', '39.468750'], 'avg_difference': ['3.426451', '3.417666', '3.401273', '3.408850', '3.422051'], 'correctness_issue': 'Output mismatch', 'correctness_trials': '(0 / 5)', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:34:18,169 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:34:18,171 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4932 chars)
2025-08-08 04:34:20,925 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:34:20,925 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":false,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:4","runtime_error":"Traceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py\", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py\", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File \"/tmp/tmpodmmnv1i.py\", line 104, in forward\n    attention_kernel[grid](\n 
2025-08-08 04:34:20,925 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ˜ wrong_answer
2025-08-08 04:34:20,926 - openevolve.evaluator - INFO - Evaluated program 5d26ab17-7f93-42f5-a35c-f29c54115159 in 2.76s: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpodmmnv1i.py", line 104, in forward\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 239, in run\n    benchmark()\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 228, in benchmark\n    timings = {config: self._bench(*args, config=config, **kwargs) for config in pruned_configs}\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 228, in <dictcomp>\n    timings = {config: self._bench(*args, config=config, **kwargs) for config in pruned_configs}\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 135, in _bench\n    raise ValueError(f"Conflicting meta-parameters: {\', \'.join(conflicts)}."\nValueError: Conflicting meta-parameters: BLOCK_N. Make sure that you don\'t re-define auto-tuned symbols.\n', 'runtime_error_name': 'builtins.ValueError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:34:20,930 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:34:20,930 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:34:20,942 - openevolve.threaded_parallel - INFO - Iteration 27: Program 5d26ab17-7f93-42f5-a35c-f29c54115159 (parent: a2f47fb2-6ca0-4451-9be8-74fe918a7230) completed in 990.48s
2025-08-08 04:34:20,943 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=0.0000, score=10.0000, stage=wrong_answer, verify_payload={'id': 'level3_50_ReLUSelfAttention', 'result': {'compiled': True, 'correctness': False, 'metadata': {'hardware': 'NVIDIA L20Y', 'device': 'cuda:4', 'runtime_error': 'Traceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/helpers/evaluations.py", line 720, in run_and_check_correctness\n    output_new = model_new(*inputs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl\n    return self._call_impl(*args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl\n    return forward_call(*args, **kwargs)\n  File "/tmp/tmpodmmnv1i.py", line 104, in forward\n    attention_kernel[grid](\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/jit.py", line 390, in <lambda>\n    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 239, in run\n    benchmark()\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 228, in benchmark\n    timings = {config: self._bench(*args, config=config, **kwargs) for config in pruned_configs}\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 228, in <dictcomp>\n    timings = {config: self._bench(*args, config=config, **kwargs) for config in pruned_configs}\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/site-packages/triton/runtime/autotuner.py", line 135, in _bench\n    raise ValueError(f"Conflicting meta-parameters: {\', \'.join(conflicts)}."\nValueError: Conflicting meta-parameters: BLOCK_N. Make sure that you don\'t re-define auto-tuned symbols.\n', 'runtime_error_name': 'builtins.ValueError', 'reference_timing_ms': 0.217, 'speed_up': -1.0, 'custom_timing': -1.0}, 'runtime': -1.0, 'runtime_stats': {}}}
2025-08-08 04:34:20,943 - openevolve.threaded_parallel - INFO - Checkpoint interval reached at iteration 27
2025-08-08 04:34:20,944 - openevolve.database - INFO - Island Status:
2025-08-08 04:34:20,944 - openevolve.database - INFO -    Island 0: 8 programs, best=20.0000, avg=15.0000, diversity=163.67, gen=10 (best: 5ab066a2-9f14-4509-bd55-98436c5190b8)
2025-08-08 04:34:20,944 - openevolve.database - INFO -  * Island 1: 8 programs, best=20.0000, avg=16.2500, diversity=97.92, gen=10 (best: 5261f736-65d3-49df-8eae-2f06372b524c)
2025-08-08 04:34:20,945 - openevolve.database - INFO -    Island 2: 9 programs, best=20.0000, avg=15.5556, diversity=179.05, gen=9 (best: 8d4dd78b-fa2c-46cc-afbe-68b4e5637a74)
2025-08-08 04:34:21,271 - openevolve.database - INFO - Saved database with 25 programs to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_27
2025-08-08 04:34:21,287 - openevolve.controller - INFO - Saved best program at checkpoint 27 with metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 04:34:21,287 - openevolve.controller - INFO - Saved checkpoint at iteration 27 to openevolve_output/level3_50_ReLUSelfAttention/checkpoints/checkpoint_27
2025-08-08 04:37:43,281 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] triton key words check pass
2025-08-08 04:37:43,283 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus payload: reference_code(2843 chars) + custom_code(4813 chars)
2025-08-08 04:37:47,422 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus request success
2025-08-08 04:37:47,422 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] verify_plus response: {"id":"level3_50_ReLUSelfAttention","result":{"compiled":true,"correctness":true,"metadata":{"hardware":"NVIDIA L20Y","device":"cuda:0","correctness_trials":"(5 / 5)","reference_timing_ms":0.217,"speed_up":0.117,"custom_timing":1.86},"runtime":1.86,"runtime_stats":{"mean":1.86,"std":0.0178,"min":1.83,"max":1.89,"num_trials":100,"hardware":"NVIDIA L20Y","device":"cuda:0"}}}
2025-08-08 04:37:47,422 - openevolve.RemoteSpeedupEvaluator - INFO - [level3_50_ReLUSelfAttention] âœ” success | speed_up=0.117  score=20.00
2025-08-08 04:37:47,423 - openevolve.evaluator - INFO - Evaluated program 585cb3b5-7a5a-4bf6-8c32-b89baadfdf7f in 4.14s: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1170, runtime_ms=1.8600, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.117, 'custom_timing': 1.86}
2025-08-08 04:37:47,427 - openevolve.database - INFO - Population size (26) exceeds limit (25), removing 1 programs
2025-08-08 04:37:47,428 - openevolve.database - INFO - Population size after cleanup: 25
2025-08-08 04:37:47,441 - openevolve.threaded_parallel - INFO - Iteration 29: Program 585cb3b5-7a5a-4bf6-8c32-b89baadfdf7f (parent: 0aa721d0-09db-465a-a398-1f2d556d1dc2) completed in 659.21s
2025-08-08 04:37:47,441 - openevolve.threaded_parallel - INFO - Metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1170, runtime_ms=1.8600, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:0', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.117, 'custom_timing': 1.86}
2025-08-08 04:37:47,441 - openevolve.threaded_parallel - INFO - Evolution completed
2025-08-08 04:37:47,448 - openevolve.threaded_parallel - INFO - Stopped thread pool
2025-08-08 04:37:47,448 - openevolve.threaded_parallel - INFO - Stopped improved parallel controller
2025-08-08 04:37:47,448 - openevolve.controller - INFO - Using tracked best program: 5ab066a2-9f14-4509-bd55-98436c5190b8
2025-08-08 04:37:47,448 - openevolve.controller - INFO - Evolution complete. Best program has metrics: compiled=1.0000, correctness=1.0000, stage=success, passed=0.0000, score=20.0000, speed_up=0.1190, runtime_ms=1.8200, meta={'hardware': 'NVIDIA L20Y', 'device': 'cuda:7', 'correctness_trials': '(5 / 5)', 'reference_timing_ms': 0.217, 'speed_up': 0.119, 'custom_timing': 1.82}
2025-08-08 04:37:47,466 - openevolve.controller - INFO - Saved best program to openevolve_output/level3_50_ReLUSelfAttention/best/best_program.py with program info to openevolve_output/level3_50_ReLUSelfAttention/best/best_program_info.json
2025-08-08 04:37:47,467 - __main__ - INFO - âœ… å®Œæˆ level3_50_ReLUSelfAttention
2025-08-08 04:37:47,467 - __main__ - INFO - ======================================================================
2025-08-08 04:37:47,467 - __main__ - INFO - ðŸš€ [6/6] å¼€å§‹ level5_14_llama2_decode
2025-08-08 04:37:47,467 - __main__ - INFO - ======================================================================
2025-08-08 04:37:47,522 - openevolve.controller - INFO - Logging to openevolve_output/level5_14_llama2_decode/logs/openevolve_20250808_043747.log
2025-08-08 04:37:47,523 - openevolve.controller - INFO - Set random seed to 42 for reproducibility
2025-08-08 04:37:47,562 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 04:37:47,601 - openevolve.llm.ensemble - INFO - Initialized LLM ensemble with models: deepseek (weight: 0.80), deepseek (weight: 0.20)
2025-08-08 04:37:47,601 - openevolve.prompt.sampler - INFO - Set custom templates: system=evaluator_system_message, user=None
2025-08-08 04:37:47,601 - openevolve.database - INFO - Initialized program database with 0 programs
2025-08-08 04:37:47,623 - openevolve.evaluator - INFO - Successfully loaded evaluation function from openevolve_output/level5_14_llama2_decode/evaluation.py
2025-08-08 04:37:47,624 - openevolve.evaluator - INFO - Initialized evaluator with openevolve_output/level5_14_llama2_decode/evaluation.py
2025-08-08 04:37:47,624 - openevolve.controller - INFO - Initialized OpenEvolve with /tmp/0702297010e16cc15892df748aa692fb.py
2025-08-08 04:37:47,624 - openevolve.controller - INFO - Adding initial program to database
2025-08-08 04:37:47,625 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus payload: reference_code(10201 chars) + custom_code(10322 chars)
2025-08-08 04:37:49,858 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus request success
2025-08-08 04:37:49,859 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus response: {"id":"level5_14_llama2_decode","result":{"error":"'NoneType' object has no attribute '__dict__'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 10, in <module>\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1184, in dataclass\n    return wrap(cls)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses
2025-08-08 04:37:49,859 - openevolve.evaluator - WARNING - Evaluation attempt 1/4 failed for program 462f6fa9-e658-404e-8766-de106a4a26ff: Error: The reference code is not valid or correct. The verify result is: {'error': '\'NoneType\' object has no attribute \'__dict__\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 10, in <module>\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1184, in dataclass\n    return wrap(cls)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses.KW_ONLY,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 711, in _is_type\n    ns = sys.modules.get(cls.__module__).__dict__\nAttributeError: \'NoneType\' object has no attribute \'__dict__\'. Did you mean: \'__dir__\'?\n'}
2025-08-08 04:37:50,867 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus payload: reference_code(10201 chars) + custom_code(10322 chars)
2025-08-08 04:37:53,067 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus request success
2025-08-08 04:37:53,067 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus response: {"id":"level5_14_llama2_decode","result":{"error":"'NoneType' object has no attribute '__dict__'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 10, in <module>\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1184, in dataclass\n    return wrap(cls)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses
2025-08-08 04:37:53,068 - openevolve.evaluator - WARNING - Evaluation attempt 2/4 failed for program 462f6fa9-e658-404e-8766-de106a4a26ff: Error: The reference code is not valid or correct. The verify result is: {'error': '\'NoneType\' object has no attribute \'__dict__\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 10, in <module>\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1184, in dataclass\n    return wrap(cls)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses.KW_ONLY,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 711, in _is_type\n    ns = sys.modules.get(cls.__module__).__dict__\nAttributeError: \'NoneType\' object has no attribute \'__dict__\'. Did you mean: \'__dir__\'?\n'}
2025-08-08 04:37:54,070 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus payload: reference_code(10201 chars) + custom_code(10322 chars)
2025-08-08 04:37:56,289 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus request success
2025-08-08 04:37:56,290 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus response: {"id":"level5_14_llama2_decode","result":{"error":"'NoneType' object has no attribute '__dict__'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 10, in <module>\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1184, in dataclass\n    return wrap(cls)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses
2025-08-08 04:37:56,290 - openevolve.evaluator - WARNING - Evaluation attempt 3/4 failed for program 462f6fa9-e658-404e-8766-de106a4a26ff: Error: The reference code is not valid or correct. The verify result is: {'error': '\'NoneType\' object has no attribute \'__dict__\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 10, in <module>\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1184, in dataclass\n    return wrap(cls)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses.KW_ONLY,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 711, in _is_type\n    ns = sys.modules.get(cls.__module__).__dict__\nAttributeError: \'NoneType\' object has no attribute \'__dict__\'. Did you mean: \'__dir__\'?\n'}
2025-08-08 04:37:57,292 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus payload: reference_code(10201 chars) + custom_code(10322 chars)
2025-08-08 04:37:59,656 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus request success
2025-08-08 04:37:59,656 - openevolve.RemoteSpeedupEvaluator - INFO - [level5_14_llama2_decode] verify_plus response: {"id":"level5_14_llama2_decode","result":{"error":"'NoneType' object has no attribute '__dict__'\nTraceback (most recent call last):\n  File \"/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py\", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File \"<string>\", line 10, in <module>\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1184, in dataclass\n    return wrap(cls)\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File \"/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py\", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses
2025-08-08 04:37:59,657 - openevolve.evaluator - WARNING - Evaluation attempt 4/4 failed for program 462f6fa9-e658-404e-8766-de106a4a26ff: Error: The reference code is not valid or correct. The verify result is: {'error': '\'NoneType\' object has no attribute \'__dict__\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 10, in <module>\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1184, in dataclass\n    return wrap(cls)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses.KW_ONLY,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 711, in _is_type\n    ns = sys.modules.get(cls.__module__).__dict__\nAttributeError: \'NoneType\' object has no attribute \'__dict__\'. Did you mean: \'__dir__\'?\n'}
2025-08-08 04:37:59,657 - openevolve.evaluator - ERROR - All evaluation attempts failed for program 462f6fa9-e658-404e-8766-de106a4a26ff. Last error: Error: The reference code is not valid or correct. The verify result is: {'error': '\'NoneType\' object has no attribute \'__dict__\'\nTraceback (most recent call last):\n  File "/cpfs01/shared/llm_kernel/hujiakai/KernelLLM/validation_api_server/evaluator.py", line 92, in _measure_perf_worker\n    exec(textwrap.dedent(code_src), temp_module.__dict__)\n  File "<string>", line 10, in <module>\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1184, in dataclass\n    return wrap(cls)\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 1175, in wrap\n    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 944, in _process_class\n    and _is_type(type, cls, dataclasses, dataclasses.KW_ONLY,\n  File "/home/lijiaxing/.conda/envs/api/lib/python3.10/dataclasses.py", line 711, in _is_type\n    ns = sys.modules.get(cls.__module__).__dict__\nAttributeError: \'NoneType\' object has no attribute \'__dict__\'. Did you mean: \'__dir__\'?\n'}
2025-08-08 04:37:59,658 - __main__ - ERROR - ðŸ’¥ å¤±è´¥ level5_14_llama2_decode: 'score'
2025-08-08 04:37:59,658 - __main__ - INFO - ----------------------------------------------------------------------
2025-08-08 04:37:59,658 - __main__ - INFO - ðŸ“Š è¿›ç¨‹ rank=24 ç»“æŸ | æˆåŠŸ 5 | å¤±è´¥ 1
2025-08-08 04:37:59,658 - __main__ - INFO - ----------------------------------------------------------------------
